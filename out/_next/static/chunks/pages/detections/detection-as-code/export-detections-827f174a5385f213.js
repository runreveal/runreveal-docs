(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1540],{54631:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/detections/detection-as-code/export-detections",function(){return s(71562)}])},71562:function(e,n,s){"use strict";s.r(n),s.d(n,{useTOC:function(){return d}});var t=s(85893),r=s(37812),a=s(84854),i=s(79299);function d(e){return[{value:"First time you export",id:"first-time-you-export",depth:2}]}n.default=(0,r.c)(function(e){let{toc:n=d(e)}=e,s={a:"a",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",span:"span",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h1,{children:"Export Detections"}),"\n",(0,t.jsx)(s.p,{children:"To get started or to adopt detection as code after already adding detections to\nyour account the RunReveal CLI has the commands necessary to bootstrap a code\nrepo from nothing, so you can"}),"\n",(0,t.jsxs)(s.p,{children:["Once you’re logged into the CLI from the ",(0,t.jsx)(s.a,{href:"/detections/detection-as-code/getting-started",children:"getting started"}),"\nsteps, you can utilize the export functionality to download all detection state\ninto a directory of your choosing."]}),"\n",(0,t.jsx)(s.pre,{tabIndex:"0","data-language":"plaintext","data-word-wrap":"",children:(0,t.jsxs)(s.code,{children:[(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:":) runreveal detections export -d ~/detection-as-code"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:":) ls -l ~/detection-as-code "})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"total 0"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"drwxr--r--   4 evan  staff   128 Jun 18 09:42 1password"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"drwxr--r--   8 evan  staff   256 Jun 18 09:42 cf-audit"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"drwxr--r--  16 evan  staff   512 Jun 18 09:42 cloudtrail"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"drwxr--r--  16 evan  staff   512 Jun 18 09:42 gcp"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"drwxr--r--  20 evan  staff   640 Jun 18 09:42 google-workspace"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"drwxr--r--   8 evan  staff   256 Jun 18 09:42 gsuite"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"drwxr--r--  18 evan  staff   576 Jun 18 09:42 notion"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"drwxr--r--  18 evan  staff   576 Jun 18 09:42 okta"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"drwxr--r--   6 evan  staff   192 Jun 18 09:42 tailscale-audit"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"drwxr--r--  60 evan  staff  1920 Jun 18 09:42 uncategorized"})})]})}),"\n",(0,t.jsxs)(s.p,{children:["These detections are categorized by sourceType and will be\nsorted into directories by the ",(0,t.jsx)(s.code,{children:"categories"})," tag if they\nmatch the name of any ",(0,t.jsx)(s.code,{children:"sourceType"})," within RunReveal."]}),"\n",(0,t.jsx)(s.p,{children:"After exporting each detection will be output into two files. The detection\nquery and the detection configuration and metadata."}),"\n",(0,t.jsx)(s.p,{children:"Here’s an example containing both the yaml and sql for our Okta detection of\na user reporting a suspicious action."}),"\n",(0,t.jsx)(s.pre,{tabIndex:"0","data-language":"plaintext","data-word-wrap":"",children:(0,t.jsxs)(s.code,{children:[(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:":) cat okta-user-suspicious-report.sql "})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"select * from okta_logs where"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"  eventType='user.account.report_suspicious_activity_by_enduser'"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"  and receivedAt > {from:DateTime} and receivedAt < {to:DateTime}%"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:":) cat okta-user-suspicious-report.yaml"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"name: okta-user-suspicious-report"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"displayName: Okta User Reported Suspicious Activity"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"description: Suspicious activity reported by end user"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"file: okta-user-suspicious-report.sql"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"categories:"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"- signal"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"- okta"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"sourceTypes:"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"- okta"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:'schedule: "*/15 * * * *"'})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"notificationNames: []"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"mitreAttacks:"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"- initial-access"})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:'severity: ""'})}),"\n",(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"riskScore: 0"})})]})}),"\n",(0,t.jsx)(s.h2,{id:n[0].id,children:n[0].value}),"\n",(0,t.jsx)(s.p,{children:"The first time you export existing detections that were made in the web ui\nyou’ll first need to upload them and force overwrite them from the CLI before\nyour CI/CD system can use them."}),"\n",(0,t.jsx)(s.p,{children:"This step will force overwrite all detections that you have in the repo so\nthey will be managed via detection as code going forward."}),"\n",(0,t.jsx)(s.pre,{tabIndex:"0","data-language":"plaintext","data-word-wrap":"",children:(0,t.jsx)(s.code,{children:(0,t.jsx)(s.span,{children:(0,t.jsx)(s.span,{children:"$ runreveal detections sync -o -d ~/detection-as-code"})})})})]})},"/detections/detection-as-code/export-detections",{filePath:"pages/detections/detection-as-code/export-detections.mdx",timestamp:1729951368e3,pageMap:a.v,frontMatter:{title:"Export Detections",description:"Export all detections from RunReveal using the CLI. Download detection state into organized directories for version control and CI/CD integration."},title:"Export Detections"},"undefined"==typeof RemoteContent?d:RemoteContent.useTOC)}},function(e){e.O(0,[7812,4854,2888,9774,179],function(){return e(e.s=54631)}),_N_E=e.O()}]);