(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6584],{96636:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/detections/detection-as-code/uploading-detections",function(){return s(48751)}])},48751:function(e,n,s){"use strict";s.r(n),s.d(n,{useTOC:function(){return r}});var d=s(85893),a=s(37812),t=s(84854),i=s(79299);function r(e){return[{value:"Test your upload",id:"test-your-upload",depth:2},{value:"Uploading",id:"uploading",depth:2},{value:"Force Uploading",id:"force-uploading",depth:2}]}n.default=(0,a.c)(function(e){let{toc:n=r(e)}=e,s={code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",span:"span",...(0,i.a)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.h1,{children:"Uploading Detections"}),"\n",(0,d.jsx)(s.p,{children:"When it’s time to upload detections, RunReveal’s CLI is built specifically to\nmake this process simple and not error prone. The upload takes place through\nour API."}),"\n",(0,d.jsx)(s.h2,{id:n[0].id,children:n[0].value}),"\n",(0,d.jsx)(s.p,{children:"When you want to test to ensure that each detection is properly formatted and\nsee which detections have been updated, deleted, or created, the dry run flag\nwill show you exactly the information you want."}),"\n",(0,d.jsx)(s.pre,{tabIndex:"0","data-language":"plaintext","data-word-wrap":"",children:(0,d.jsxs)(s.code,{children:[(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"$ runreveal detections sync -d ~/detection-as-code --dry-run                                                            "})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"processing '/Users/evan/detection-as-code/1password/1password-unusual-client.yaml'                                           "})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"processing '/Users/evan/detection-as-code/cf-audit/anomalous-api-key-usage.yaml'                                             "})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"processing '/Users/evan/detection-as-code/cf-audit/new-cloudflare-api-key.yaml'                                              "})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"processing '/Users/evan/detection-as-code/cf-audit/user-added-removed-cloudflare.yaml"})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"..."})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"{                                                                                                                            "})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:'     "detections": {                                                                                                         '})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:'         "added": [                                                                                                                                                                                                                                       '})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:'             "1password-unusual-client",                                                                                                                                                                                                             '})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:'             "anomalous-api-key-usage",                                                                                                                                                                                                                 '})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:'             "new-cloudflare-api-key",                                                                                                                                                                                                                        '})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"         ],"})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:'         "deleted": [],                                                                                                                                                                                                                                   '})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:'         "updated": [                                                                                                                                                                                                                                     '})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:'             "user-added-removed-cloudflare"                                                                                         '})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"         ]                                                                                                                   "})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"     },                                                                                                                      "})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:'     "dryRun": true                                                                                                          '})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:" }                          "})})]})}),"\n",(0,d.jsx)(s.h2,{id:n[1].id,children:n[1].value}),"\n",(0,d.jsxs)(s.p,{children:["The only difference between uploading and performing a dryrun is the ",(0,d.jsx)(s.code,{children:"--dry-run"})," flag.\nRemove the ",(0,d.jsx)(s.code,{children:"--dry-run"})," flag and your detections will be uploaded."]}),"\n",(0,d.jsx)(s.pre,{tabIndex:"0","data-language":"plaintext","data-word-wrap":"",children:(0,d.jsx)(s.code,{children:(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"$ runreveal detections sync -d ~/detection-as-code"})})})}),"\n",(0,d.jsx)(s.p,{children:"If you created a detection in the UI, and then attempt to upload your detection\nfrom the CLI you will see an error message the first time you attempt to\noverwrite your UI detection."}),"\n",(0,d.jsx)(s.p,{children:"It will look a little something like this:"}),"\n",(0,d.jsx)(s.pre,{tabIndex:"0","data-language":"plaintext","data-word-wrap":"",children:(0,d.jsxs)(s.code,{children:[(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"$ runreveal detections sync -d ~/detection-as-code --dry-run                                                            "})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"processing '/Users/evan/detection-as-code/1password/1password-unusual-client.yaml'                                           "})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"processing '/Users/evan/detection-as-code/cf-audit/anomalous-api-key-usage.yaml'                                             "})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"processing '/Users/evan/detection-as-code/cf-audit/new-cloudflare-api-key.yaml'                                              "})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"processing '/Users/evan/detection-as-code/cf-audit/user-added-removed-cloudflare.yaml"})}),"\n",(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"ERROR  This detection name is already in use, please choose a different name. If you're trying to upload your detections using detection as code, try the -o flag to overwrite existing detections created in the UI."})})]})}),"\n",(0,d.jsxs)(s.p,{children:["If you see this error, then adding the ",(0,d.jsx)(s.code,{children:"-o"})," flag will overwrite the existing\ndetection and convert the detection from being ",(0,d.jsx)(s.code,{children:"web"})," managed to being ",(0,d.jsx)(s.code,{children:"cli"}),"\nmanaged."]}),"\n",(0,d.jsx)(s.h2,{id:n[2].id,children:n[2].value}),"\n",(0,d.jsx)(s.p,{children:"If you receive an error because the detections are managed with the web interface\nyou’ll need to run the following command to convert your detections to managed\nby the CLI"}),"\n",(0,d.jsx)(s.pre,{tabIndex:"0","data-language":"plaintext","data-word-wrap":"",children:(0,d.jsx)(s.code,{children:(0,d.jsx)(s.span,{children:(0,d.jsx)(s.span,{children:"$ runreveal detections sync -o -d ~/detection-as-code"})})})})]})},"/detections/detection-as-code/uploading-detections",{filePath:"pages/detections/detection-as-code/uploading-detections.mdx",timestamp:1729951368e3,pageMap:t.v,frontMatter:{title:"Uploading Detections",description:"Upload detection files to RunReveal using the CLI. Test uploads with dry-run, handle conflicts, and manage detection lifecycle through version control."},title:"Uploading Detections"},"undefined"==typeof RemoteContent?r:RemoteContent.useTOC)}},function(e){e.O(0,[7812,4854,2888,9774,179],function(){return e(e.s=96636)}),_N_E=e.O()}]);