(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2744],{47262:function(i,s,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sources/source-types/aws/flow",function(){return e(29260)}])},29260:function(i,s,e){"use strict";e.r(s),e.d(s,{useTOC:function(){return a}});var n=e(85893),l=e(37812),r=e(84854),t=e(79299),h=e(95956);function a(i){return[{value:"Ingest Methods",id:"ingest-methods",depth:2},{value:"Setup",id:"setup",depth:2},{value:"Step 1: Create an S3 Bucket",id:"step-1-create-an-s3-bucket",depth:3},{value:"Step 2: Configure Bucket Policy",id:"step-2-configure-bucket-policy",depth:3},{value:"Step 3: Create a Flow Log",id:"step-3-create-a-flow-log",depth:3},{value:"Step 4: Verify Log Delivery",id:"step-4-verify-log-delivery",depth:3}]}s.default=(0,l.c)(function(i){let{toc:s=a(i)}=i,e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",ul:"ul",...(0,t.a)(),...i.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.h1,{children:"VPC Flow Logs"}),"\n",(0,n.jsx)(e.p,{children:"AWS VPC Flow Logs capture information about the IP traffic going to and from network interfaces in a Virtual Private Cloud (VPC). These logs provide details such as source and destination IP addresses, ports, protocols, traffic direction, and the acceptance or rejection of the traffic. They are useful for network monitoring, troubleshooting connectivity issues, and auditing traffic for security analysis."}),"\n",(0,n.jsx)(e.h2,{id:s[0].id,children:s[0].value}),"\n",(0,n.jsx)(e.p,{children:"Setup the ingestion of this source using one of the following guides."}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:"/sources/object-storage/s3",children:"AWS S3 Bucket"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:"/sources/object-storage/external-s3",children:"AWS S3 Bucket with Custom SQS"})}),"\n"]}),"\n",(0,n.jsxs)(h.U,{type:"info",children:[(0,n.jsx)(e.p,{children:"If using an AWS S3 bucket use the following SNS topic ARN to send your bucket notifications."}),(0,n.jsx)(e.pre,{tabIndex:"0","data-language":"plaintext","data-word-wrap":"",children:(0,n.jsx)(e.code,{children:(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{children:"arn:aws:sns:<REGION>:253602268883:runreveal_flow"})})})})]}),"\n",(0,n.jsx)(e.h2,{id:s[1].id,children:s[1].value}),"\n",(0,n.jsx)(e.h3,{id:s[2].id,children:s[2].value}),"\n",(0,n.jsxs)(e.ol,{children:["\n",(0,n.jsx)(e.li,{children:"Sign in to the AWS Management Console and open the Amazon S3 console."}),"\n",(0,n.jsx)(e.li,{children:"Click on “Create bucket”."}),"\n",(0,n.jsx)(e.li,{children:"Enter a unique name for your bucket (e.g., “my-vpc-flow-logs-bucket”)."}),"\n",(0,n.jsx)(e.li,{children:"Select the region where your VPC is located."}),"\n",(0,n.jsx)(e.li,{children:"Configure the bucket settings as needed (e.g., versioning, encryption)."}),"\n",(0,n.jsx)(e.li,{children:"Click “Create bucket” to finish."}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:s[3].id,children:s[3].value}),"\n",(0,n.jsxs)(e.ol,{children:["\n",(0,n.jsx)(e.li,{children:"In the S3 console, select the bucket you just created."}),"\n",(0,n.jsx)(e.li,{children:"Go to the “Permissions” tab."}),"\n",(0,n.jsx)(e.li,{children:"Under “Bucket policy”, click “Edit”."}),"\n",(0,n.jsxs)(e.li,{children:["Paste the following policy, replacing ",(0,n.jsx)(e.code,{children:"{your-bucket-name}"})," with your actual bucket name:"]}),"\n"]}),"\n",(0,n.jsx)(e.pre,{tabIndex:"0","data-language":"json","data-word-wrap":"",children:(0,n.jsxs)(e.code,{children:[(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"{"})}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'    "Version"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"2012-10-17"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'    "Statement"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": ["})]}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"        {"})}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Sid"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"AWSLogDeliveryWrite"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Effect"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"Allow"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Principal"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": {"}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'"Service"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"delivery.logs.amazonaws.com"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"},"})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Action"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"s3:PutObject"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Resource"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"arn:aws:s3:::{your-bucket-name}/AWSLogs/*"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Condition"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": {"})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'                "StringEquals"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": {"})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'                    "s3:x-amz-acl"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"bucket-owner-full-control"'})]}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"                }"})}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"            }"})}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"        },"})}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"        {"})}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Sid"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"AWSLogDeliveryAclCheck"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Effect"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"Allow"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Principal"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": {"}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'"Service"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"delivery.logs.amazonaws.com"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"},"})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Action"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"s3:GetBucketAcl"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Resource"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"arn:aws:s3:::{your-bucket-name}"'})]}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"        }"})}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"    ]"})}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"}"})})]})}),"\n",(0,n.jsxs)(e.ol,{start:"5",children:["\n",(0,n.jsx)(e.li,{children:"Click “Save changes”."}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:s[4].id,children:s[4].value}),"\n",(0,n.jsxs)(e.ol,{children:["\n",(0,n.jsx)(e.li,{children:"Open the Amazon VPC console."}),"\n",(0,n.jsx)(e.li,{children:"In the navigation pane, choose “Your VPCs”."}),"\n",(0,n.jsx)(e.li,{children:"Select the VPC for which you want to create a flow log."}),"\n",(0,n.jsx)(e.li,{children:"Choose the “Flow logs” tab."}),"\n",(0,n.jsx)(e.li,{children:"Choose “Create flow log”."}),"\n",(0,n.jsxs)(e.li,{children:["Configure the flow log:","\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"For “Filter”, choose “All” to capture all traffic."}),"\n",(0,n.jsx)(e.li,{children:"For “Maximum aggregation interval”, choose your preferred interval."}),"\n",(0,n.jsx)(e.li,{children:"For “Destination”, select “Send to an S3 bucket”."}),"\n",(0,n.jsxs)(e.li,{children:["For “S3 bucket ARN”, enter the ARN of the bucket you created (format: ",(0,n.jsx)(e.code,{children:"arn:aws:s3:::{your-bucket-name}"}),")."]}),"\n",(0,n.jsx)(e.li,{children:"Optionally, specify a “Log file format” if you want to customize the fields."}),"\n",(0,n.jsx)(e.li,{children:"For “Log record format”, choose your preferred format (e.g., AWS default format)."}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(e.li,{children:"Choose “Create flow log”."}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:s[5].id,children:s[5].value}),"\n",(0,n.jsxs)(e.ol,{children:["\n",(0,n.jsx)(e.li,{children:"Wait for some time to allow traffic to generate logs (this may take up to 15 minutes)."}),"\n",(0,n.jsx)(e.li,{children:"Go to the S3 console and open your bucket."}),"\n",(0,n.jsxs)(e.li,{children:["You should see folders created with the structure: ",(0,n.jsx)(e.code,{children:"AWSLogs/{aws-account-id}/vpcflowlogs/{region}/{year}/{month}/{day}/"})]}),"\n",(0,n.jsx)(e.li,{children:"Inside these folders, you’ll find your VPC Flow Log files."}),"\n"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.p,{children:["For more information, refer to the ",(0,n.jsx)(e.a,{href:"https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html",children:"official AWS documentation on VPC Flow Logs"}),"."]})]})},"/sources/source-types/aws/flow",{filePath:"pages/sources/source-types/aws/flow.mdx",timestamp:1727468932e3,pageMap:r.v,frontMatter:{title:"AWS VPC Flow Logs",description:"Collect AWS VPC Flow Logs for network traffic monitoring and security analysis. Track IP traffic patterns, connection attempts, and network behavior across your VPC infrastructure."},title:"AWS VPC Flow Logs"},"undefined"==typeof RemoteContent?a:RemoteContent.useTOC)},95956:function(i,s,e){"use strict";e.d(s,{U:function(){return a}});var n=e(85893),l=e(90512),r=e(45192);let t={default:"\uD83D\uDCA1",error:"\uD83D\uDEAB",info:(0,n.jsx)(r.AV,{className:"_mt-1"}),warning:"⚠️"},h={default:(0,l.Z)("_border-orange-100 _bg-orange-50 _text-orange-800 dark:_border-orange-400/30 dark:_bg-orange-400/20 dark:_text-orange-300"),error:(0,l.Z)("_border-red-200 _bg-red-100 _text-red-900 dark:_border-red-200/30 dark:_bg-red-900/30 dark:_text-red-200"),info:(0,l.Z)("_border-blue-200 _bg-blue-100 _text-blue-900 dark:_border-blue-200/30 dark:_bg-blue-900/30 dark:_text-blue-200"),warning:(0,l.Z)("_border-yellow-100 _bg-yellow-50 _text-yellow-900 dark:_border-yellow-200/30 dark:_bg-yellow-700/30 dark:_text-yellow-200")};function a({children:i,type:s="default",emoji:e=t[s]}){return(0,n.jsxs)("div",{className:(0,l.Z)("nextra-callout _overflow-x-auto _mt-6 _flex _rounded-lg _border _py-2 ltr:_pr-4 rtl:_pl-4","contrast-more:_border-current contrast-more:dark:_border-current",h[s]),children:[(0,n.jsx)("div",{className:"_select-none _text-xl ltr:_pl-3 ltr:_pr-2 rtl:_pr-3 rtl:_pl-2",style:{fontFamily:'"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"'},children:e}),(0,n.jsx)("div",{className:"_w-full _min-w-0 _leading-7",children:i})]})}}},function(i){i.O(0,[7812,4854,2888,9774,179],function(){return i(i.s=47262)}),_N_E=i.O()}]);