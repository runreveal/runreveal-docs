(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5275],{59514:function(e,n,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sources/source-types/aws/dns",function(){return o(35532)}])},35532:function(e,n,o){"use strict";o.r(n),o.d(n,{useTOC:function(){return d}});var r=o(85893),i=o(37812),s=o(84854),t=o(79299),l=o(95956);function d(e){return[{value:"Ingest Methods",id:"ingest-methods",depth:2},{value:"Setup",id:"setup",depth:2},{value:"Step 1: Enable VPC DNS Query Logging",id:"step-1-enable-vpc-dns-query-logging",depth:3},{value:"Step 2: Create an S3 Bucket",id:"step-2-create-an-s3-bucket",depth:3},{value:"Step 3: Create an IAM Role for CloudWatch Logs",id:"step-3-create-an-iam-role-for-cloudwatch-logs",depth:3},{value:"Step 4: Create a CloudWatch Logs Subscription Filter",id:"step-4-create-a-cloudwatch-logs-subscription-filter",depth:3},{value:"Step 5: Verify Log Delivery",id:"step-5-verify-log-delivery",depth:3}]}n.default=(0,i.c)(function(e){let{toc:n=d(e)}=e,o={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",ul:"ul",...(0,t.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.h1,{children:"AWS DNS Logs"}),"\n",(0,r.jsx)(o.p,{children:"AWS VPC DNS provides DNS resolution within a Virtual Private Cloud (VPC), allowing instances to resolve domain names to IP addresses.\nDNS query logs, captured via Amazon Route 53 Resolver query logging, provide insight into DNS queries made by resources in the VPC,\nincluding the domain names requested, source IP, and response codes. This helps with network troubleshooting, security monitoring,\nand identifying potentially malicious domains."}),"\n",(0,r.jsx)(o.h2,{id:n[0].id,children:n[0].value}),"\n",(0,r.jsx)(o.p,{children:"Setup the ingestion of this source using one of the following guides."}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsx)(o.li,{children:(0,r.jsx)(o.a,{href:"/sources/object-storage/s3",children:"AWS S3 Bucket"})}),"\n",(0,r.jsx)(o.li,{children:(0,r.jsx)(o.a,{href:"/sources/object-storage/external-s3",children:"AWS S3 Bucket with Custom SQS"})}),"\n"]}),"\n",(0,r.jsxs)(l.U,{type:"info",children:[(0,r.jsx)(o.p,{children:"If using an AWS S3 bucket use the following SNS topic ARN to send your bucket notifications."}),(0,r.jsx)(o.pre,{tabIndex:"0","data-language":"plaintext","data-word-wrap":"",children:(0,r.jsx)(o.code,{children:(0,r.jsx)(o.span,{children:(0,r.jsx)(o.span,{children:"arn:aws:sns:<REGION>:253602268883:runreveal_awsdns"})})})})]}),"\n",(0,r.jsx)(o.h2,{id:n[1].id,children:n[1].value}),"\n",(0,r.jsx)(o.h3,{id:n[2].id,children:n[2].value}),"\n",(0,r.jsxs)(o.ol,{children:["\n",(0,r.jsx)(o.li,{children:"Sign in to the AWS Management Console and open the Amazon VPC console."}),"\n",(0,r.jsx)(o.li,{children:"In the navigation pane, choose “Your VPCs”."}),"\n",(0,r.jsx)(o.li,{children:"Select the VPC for which you want to enable DNS query logging."}),"\n",(0,r.jsx)(o.li,{children:"Choose “Actions” > “Edit DNS hostnames”."}),"\n",(0,r.jsx)(o.li,{children:"Select “Enable” for DNS hostnames if it’s not already enabled."}),"\n",(0,r.jsx)(o.li,{children:"Choose “Save changes”."}),"\n",(0,r.jsx)(o.li,{children:"Now, choose “Actions” > “Edit DNS resolution”."}),"\n",(0,r.jsx)(o.li,{children:"Select “Enable” for DNS resolution if it’s not already enabled."}),"\n",(0,r.jsx)(o.li,{children:"Choose “Save changes”."}),"\n",(0,r.jsx)(o.li,{children:"Finally, choose “Actions” > “Edit VPC settings”."}),"\n",(0,r.jsx)(o.li,{children:"Scroll down to “DNS query logging” and select “Enable”."}),"\n",(0,r.jsx)(o.li,{children:"For “Destination”, choose “Send to CloudWatch Logs”."}),"\n",(0,r.jsxs)(o.li,{children:["For “Log group name”, enter a name (e.g., ",(0,r.jsx)(o.code,{children:"/aws/vpc/dns/<your-vpc-id>"}),")."]}),"\n",(0,r.jsx)(o.li,{children:"Choose “Save changes”."}),"\n"]}),"\n",(0,r.jsx)(o.h3,{id:n[3].id,children:n[3].value}),"\n",(0,r.jsxs)(o.ol,{children:["\n",(0,r.jsx)(o.li,{children:"Open the Amazon S3 console."}),"\n",(0,r.jsx)(o.li,{children:"Click on “Create bucket”."}),"\n",(0,r.jsx)(o.li,{children:"Enter a unique name for your bucket and select the region."}),"\n",(0,r.jsx)(o.li,{children:"Configure the bucket settings as needed (e.g., versioning, encryption)."}),"\n",(0,r.jsx)(o.li,{children:"Click “Create bucket” to finish."}),"\n"]}),"\n",(0,r.jsx)(o.h3,{id:n[4].id,children:n[4].value}),"\n",(0,r.jsxs)(o.ol,{children:["\n",(0,r.jsx)(o.li,{children:"Open the IAM console."}),"\n",(0,r.jsx)(o.li,{children:"In the navigation pane, choose “Roles”, then “Create role”."}),"\n",(0,r.jsx)(o.li,{children:"For “Trusted entity type”, choose “AWS service”."}),"\n",(0,r.jsx)(o.li,{children:"For “Use case”, choose “CloudWatch Logs” from the dropdown."}),"\n",(0,r.jsx)(o.li,{children:"Choose “Next”."}),"\n",(0,r.jsx)(o.li,{children:"In the “Add permissions” page, search for and select “AWSCloudWatchLogsFullAccess”."}),"\n",(0,r.jsx)(o.li,{children:"Choose “Next”."}),"\n",(0,r.jsx)(o.li,{children:"Enter a name for the role (e.g., “CloudWatchLogsToS3Role”)."}),"\n",(0,r.jsx)(o.li,{children:"Review the role details and choose “Create role”."}),"\n"]}),"\n",(0,r.jsx)(o.h3,{id:n[5].id,children:n[5].value}),"\n",(0,r.jsxs)(o.ol,{children:["\n",(0,r.jsx)(o.li,{children:"Open the CloudWatch console."}),"\n",(0,r.jsx)(o.li,{children:"In the navigation pane, choose “Log groups”."}),"\n",(0,r.jsx)(o.li,{children:"Find and select the log group you created for VPC DNS logs."}),"\n",(0,r.jsx)(o.li,{children:"Choose “Subscription filters” tab, then “Create subscription filter”."}),"\n",(0,r.jsx)(o.li,{children:"For “Filter pattern”, enter an empty string to capture all log events."}),"\n",(0,r.jsx)(o.li,{children:"For “Subscription filter destination”, choose “Amazon S3 bucket”."}),"\n",(0,r.jsx)(o.li,{children:"Select the S3 bucket you created earlier."}),"\n",(0,r.jsx)(o.li,{children:"For “Log format”, choose “JSON”."}),"\n",(0,r.jsx)(o.li,{children:"For “Compression type”, choose your preferred compression method (e.g., Gzip)."}),"\n",(0,r.jsx)(o.li,{children:"For “IAM role”, select the role you created in Step 3."}),"\n",(0,r.jsx)(o.li,{children:"Choose “Start streaming”."}),"\n"]}),"\n",(0,r.jsx)(o.h3,{id:n[6].id,children:n[6].value}),"\n",(0,r.jsxs)(o.ol,{children:["\n",(0,r.jsx)(o.li,{children:"Wait for some time to allow DNS queries to generate logs."}),"\n",(0,r.jsx)(o.li,{children:"Go to the S3 console and open your bucket."}),"\n",(0,r.jsxs)(o.li,{children:["You should see folders created with the structure: ",(0,r.jsx)(o.code,{children:"{your-log-group-name}/{year}/{month}/{day}/{hour}/"})]}),"\n",(0,r.jsx)(o.li,{children:"Inside these folders, you’ll find your VPC DNS log files."}),"\n"]}),"\n",(0,r.jsx)(o.hr,{}),"\n",(0,r.jsxs)(o.p,{children:["For more information, refer to the ",(0,r.jsx)(o.a,{href:"https://docs.aws.amazon.com/vpc/latest/userguide/vpc-dns.html#vpc-dns-viewing-queries",children:"official AWS documentation on VPC DNS Query Logging"}),"."]})]})},"/sources/source-types/aws/dns",{filePath:"pages/sources/source-types/aws/dns.mdx",timestamp:1727468932e3,pageMap:s.v,frontMatter:{title:"AWS DNS Logs",description:"Collect AWS VPC DNS query logs for network monitoring and security analysis. Track DNS resolution patterns, domain queries, and potential malicious domain access across your VPC infrastructure."},title:"AWS DNS Logs"},"undefined"==typeof RemoteContent?d:RemoteContent.useTOC)},95956:function(e,n,o){"use strict";o.d(n,{U:function(){return d}});var r=o(85893),i=o(90512),s=o(45192);let t={default:"\uD83D\uDCA1",error:"\uD83D\uDEAB",info:(0,r.jsx)(s.AV,{className:"_mt-1"}),warning:"⚠️"},l={default:(0,i.Z)("_border-orange-100 _bg-orange-50 _text-orange-800 dark:_border-orange-400/30 dark:_bg-orange-400/20 dark:_text-orange-300"),error:(0,i.Z)("_border-red-200 _bg-red-100 _text-red-900 dark:_border-red-200/30 dark:_bg-red-900/30 dark:_text-red-200"),info:(0,i.Z)("_border-blue-200 _bg-blue-100 _text-blue-900 dark:_border-blue-200/30 dark:_bg-blue-900/30 dark:_text-blue-200"),warning:(0,i.Z)("_border-yellow-100 _bg-yellow-50 _text-yellow-900 dark:_border-yellow-200/30 dark:_bg-yellow-700/30 dark:_text-yellow-200")};function d({children:e,type:n="default",emoji:o=t[n]}){return(0,r.jsxs)("div",{className:(0,i.Z)("nextra-callout _overflow-x-auto _mt-6 _flex _rounded-lg _border _py-2 ltr:_pr-4 rtl:_pl-4","contrast-more:_border-current contrast-more:dark:_border-current",l[n]),children:[(0,r.jsx)("div",{className:"_select-none _text-xl ltr:_pl-3 ltr:_pr-2 rtl:_pr-3 rtl:_pl-2",style:{fontFamily:'"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"'},children:o}),(0,r.jsx)("div",{className:"_w-full _min-w-0 _leading-7",children:e})]})}}},function(e){e.O(0,[7812,4854,2888,9774,179],function(){return e(e.s=59514)}),_N_E=e.O()}]);