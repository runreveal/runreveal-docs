(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7963],{81019:function(i,s,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sources/source-types/aws/guardduty",function(){return e(65462)}])},65462:function(i,s,e){"use strict";e.r(s),e.d(s,{useTOC:function(){return d}});var n=e(85893),r=e(37812),t=e(84854),l=e(79299),h=e(95956);function d(i){return[{value:"Ingest Methods",id:"ingest-methods",depth:2},{value:"Setup",id:"setup",depth:2},{value:"Step 1: Enable GuardDuty",id:"step-1-enable-guardduty",depth:3},{value:"Step 2: Create an S3 Bucket",id:"step-2-create-an-s3-bucket",depth:3},{value:"Step 3: Configure Bucket Policy",id:"step-3-configure-bucket-policy",depth:3},{value:"Step 4: Configure GuardDuty to Send Findings to S3",id:"step-4-configure-guardduty-to-send-findings-to-s3",depth:3},{value:"Step 5: Verify Findings Export",id:"step-5-verify-findings-export",depth:3}]}s.default=(0,r.c)(function(i){let{toc:s=d(i)}=i,e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",ul:"ul",...(0,l.a)(),...i.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.h1,{children:"GuardDuty"}),"\n",(0,n.jsx)(e.p,{children:"AWS GuardDuty is a threat detection service that continuously monitors your AWS accounts, networks, and workloads for malicious or unauthorized behavior. GuardDuty logs provide findings that identify potential security threats such as compromised instances, unusual API calls, reconnaissance activity, and anomalous behavior. These findings help in enhancing cloud security by providing actionable insights for incident response and threat mitigation."}),"\n",(0,n.jsx)(e.h2,{id:s[0].id,children:s[0].value}),"\n",(0,n.jsx)(e.p,{children:"Setup the ingestion of this source using one of the following guides."}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:"/sources/object-storage/s3",children:"AWS S3 Bucket"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:"/sources/object-storage/external-s3",children:"AWS S3 Bucket with Custom SQS"})}),"\n"]}),"\n",(0,n.jsxs)(h.U,{type:"info",children:[(0,n.jsx)(e.p,{children:"If using an AWS S3 bucket use the following SNS topic ARN to send your bucket notifications."}),(0,n.jsx)(e.pre,{tabIndex:"0","data-language":"plaintext","data-word-wrap":"",children:(0,n.jsx)(e.code,{children:(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{children:"arn:aws:sns:<REGION>:253602268883:runreveal_guardduty"})})})})]}),"\n",(0,n.jsx)(e.h2,{id:s[1].id,children:s[1].value}),"\n",(0,n.jsx)(e.h3,{id:s[2].id,children:s[2].value}),"\n",(0,n.jsxs)(e.ol,{children:["\n",(0,n.jsx)(e.li,{children:"Sign in to the AWS Management Console and open the GuardDuty console."}),"\n",(0,n.jsx)(e.li,{children:"If you haven’t used GuardDuty before, you’ll see a “Get Started” page. Click “Enable GuardDuty”."}),"\n",(0,n.jsx)(e.li,{children:"If you’ve used GuardDuty before, ensure it’s enabled for the desired regions."}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:s[3].id,children:s[3].value}),"\n",(0,n.jsxs)(e.ol,{children:["\n",(0,n.jsx)(e.li,{children:"Open the Amazon S3 console."}),"\n",(0,n.jsx)(e.li,{children:"Click on “Create bucket”."}),"\n",(0,n.jsx)(e.li,{children:"Enter a unique name for your bucket (e.g., “my-guardduty-findings-bucket”)."}),"\n",(0,n.jsx)(e.li,{children:"Select the region where you want to store your findings."}),"\n",(0,n.jsx)(e.li,{children:"Configure the bucket settings as needed (e.g., versioning, encryption)."}),"\n",(0,n.jsx)(e.li,{children:"Click “Create bucket” to finish."}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:s[4].id,children:s[4].value}),"\n",(0,n.jsxs)(e.ol,{children:["\n",(0,n.jsx)(e.li,{children:"In the S3 console, select the bucket you just created."}),"\n",(0,n.jsx)(e.li,{children:"Go to the “Permissions” tab."}),"\n",(0,n.jsx)(e.li,{children:"Under “Bucket policy”, click “Edit”."}),"\n",(0,n.jsxs)(e.li,{children:["Paste the following policy, replacing ",(0,n.jsx)(e.code,{children:"{your-bucket-name}"})," with your actual bucket name and ",(0,n.jsx)(e.code,{children:"{your-account-id}"})," with your AWS account ID:"]}),"\n"]}),"\n",(0,n.jsx)(e.pre,{tabIndex:"0","data-language":"json","data-word-wrap":"",children:(0,n.jsxs)(e.code,{children:[(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"{"})}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'    "Version"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"2012-10-17"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'    "Statement"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": ["})]}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"        {"})}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Sid"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"AllowGuardDutyToCreateObjects"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Effect"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"Allow"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Principal"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": {"})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'                "Service"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"guardduty.amazonaws.com"'})]}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"            },"})}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Action"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"s3:PutObject"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Resource"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"arn:aws:s3:::{your-bucket-name}/*"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Condition"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": {"})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'                "StringEquals"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": {"})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'                    "aws:SourceAccount"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"{your-account-id}"'})]}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"                }"})}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"            }"})}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"        },"})}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"        {"})}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Sid"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"AllowGuardDutyToGetBucketLocation"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Effect"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"Allow"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Principal"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": {"})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'                "Service"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"guardduty.amazonaws.com"'})]}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"            },"})}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Action"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"s3:GetBucketLocation"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Resource"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"arn:aws:s3:::{your-bucket-name}"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'            "Condition"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": {"})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'                "StringEquals"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": {"})]}),"\n",(0,n.jsxs)(e.span,{children:[(0,n.jsx)(e.span,{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"},children:'                    "aws:SourceAccount"'}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:'"{your-account-id}"'})]}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"                }"})}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"            }"})}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"        }"})}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"    ]"})}),"\n",(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"}"})})]})}),"\n",(0,n.jsxs)(e.ol,{start:"5",children:["\n",(0,n.jsx)(e.li,{children:"Click “Save changes”."}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:s[5].id,children:s[5].value}),"\n",(0,n.jsxs)(e.ol,{children:["\n",(0,n.jsx)(e.li,{children:"Return to the GuardDuty console."}),"\n",(0,n.jsx)(e.li,{children:"In the navigation pane, choose “Settings”."}),"\n",(0,n.jsx)(e.li,{children:"In the “Findings export options” section, choose “Configure now” (or “Edit” if already configured)."}),"\n",(0,n.jsx)(e.li,{children:"For “Frequency for updated findings”, choose your preferred frequency."}),"\n",(0,n.jsx)(e.li,{children:"For “Choose export method”, select “Send to S3 bucket”."}),"\n",(0,n.jsx)(e.li,{children:"For “Bucket name”, enter the name of the S3 bucket you created."}),"\n",(0,n.jsx)(e.li,{children:"Optionally, enter a “KMS encryption key” if you want to encrypt the exported findings."}),"\n",(0,n.jsx)(e.li,{children:"Choose “Save”."}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:s[6].id,children:s[6].value}),"\n",(0,n.jsxs)(e.ol,{children:["\n",(0,n.jsx)(e.li,{children:"GuardDuty will now export findings to your S3 bucket at the frequency you specified."}),"\n",(0,n.jsxs)(e.li,{children:["To verify, you can go to your S3 bucket and look for new objects. The path will typically be:\n",(0,n.jsx)(e.code,{children:"AWSLogs/{your-account-id}/GuardDuty/{region}/year/month/day/"})]}),"\n",(0,n.jsx)(e.li,{children:"Note that if you don’t have any findings yet, no files will be exported."}),"\n"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.p,{children:["For more information, refer to the ",(0,n.jsx)(e.a,{href:"https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",children:"official AWS documentation on GuardDuty"}),"."]})]})},"/sources/source-types/aws/guardduty",{filePath:"pages/sources/source-types/aws/guardduty.mdx",timestamp:1727468932e3,pageMap:t.v,frontMatter:{title:"AWS GuardDuty",description:"Collect AWS GuardDuty findings for threat detection and response. Monitor malicious behavior, compromised instances, and anomalous API activity across your AWS environment."},title:"AWS GuardDuty"},"undefined"==typeof RemoteContent?d:RemoteContent.useTOC)},95956:function(i,s,e){"use strict";e.d(s,{U:function(){return d}});var n=e(85893),r=e(90512),t=e(45192);let l={default:"\uD83D\uDCA1",error:"\uD83D\uDEAB",info:(0,n.jsx)(t.AV,{className:"_mt-1"}),warning:"⚠️"},h={default:(0,r.Z)("_border-orange-100 _bg-orange-50 _text-orange-800 dark:_border-orange-400/30 dark:_bg-orange-400/20 dark:_text-orange-300"),error:(0,r.Z)("_border-red-200 _bg-red-100 _text-red-900 dark:_border-red-200/30 dark:_bg-red-900/30 dark:_text-red-200"),info:(0,r.Z)("_border-blue-200 _bg-blue-100 _text-blue-900 dark:_border-blue-200/30 dark:_bg-blue-900/30 dark:_text-blue-200"),warning:(0,r.Z)("_border-yellow-100 _bg-yellow-50 _text-yellow-900 dark:_border-yellow-200/30 dark:_bg-yellow-700/30 dark:_text-yellow-200")};function d({children:i,type:s="default",emoji:e=l[s]}){return(0,n.jsxs)("div",{className:(0,r.Z)("nextra-callout _overflow-x-auto _mt-6 _flex _rounded-lg _border _py-2 ltr:_pr-4 rtl:_pl-4","contrast-more:_border-current contrast-more:dark:_border-current",h[s]),children:[(0,n.jsx)("div",{className:"_select-none _text-xl ltr:_pl-3 ltr:_pr-2 rtl:_pr-3 rtl:_pl-2",style:{fontFamily:'"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"'},children:e}),(0,n.jsx)("div",{className:"_w-full _min-w-0 _leading-7",children:i})]})}}},function(i){i.O(0,[7812,4854,2888,9774,179],function(){return i(i.s=81019)}),_N_E=i.O()}]);