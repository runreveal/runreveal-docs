(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1593],{50326:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sources/object-storage/azure",function(){return n(79114)}])},79114:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h},useTOC:function(){return u}});var r=n(85893),o=n(37812),a=n(84854),s=n(79299),i={src:"/_next/static/media/azure-client-secret.e93ef02d.png",height:240,width:1068,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAACCAIAAADq9gq6AAAALklEQVR42h3IwQ0AIAgDQPefFhISaSuo4Z639shMAYeUdMcC0N2/aCZ3RlCqqgeSvS7Q4rVq3QAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:2},c={src:"/_next/static/media/azure-event-sub-setup.823220ef.png",height:942,width:1588,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAMAAABPT11nAAAAM1BMVEX////+/v7+/f79/f79/f38/P38/Pz7+/37+/v6+vr5+fr5+fn4+Pj19vf19vb19fXz9PXoSEVPAAAALElEQVR42hXBhxEAIAgDwMSCUbDsP63HP94ekpthuhpVKnx1IsUyJtwTBpIfF/4A6JE0qCoAAAAASUVORK5CYII=",blurWidth:8,blurHeight:5},l={src:"/_next/static/media/azure-source-setup.deef0743.png",height:464,width:1066,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADBAMAAABc5lN7AAAAJFBMVEX+///+/v79/f/8/f78/P77+/35+fv4+Pv39/r19vjy8/Xx8fURFwtJAAAAF0lEQVR42mPYkVbCyDDZ2NiYYamysTEAIbgD7rwM9S8AAAAASUVORK5CYII=",blurWidth:8,blurHeight:3},d=n(95956);function u(e){return[{value:"App Registration",id:"app-registration",depth:2},{value:"App Secret",id:"app-secret",depth:3},{value:"Storage Account Setup",id:"storage-account-setup",depth:2},{value:"Deployment Template",id:"deployment-template",depth:3},{value:"Manual Setup",id:"manual-setup",depth:3},{value:"Storage Account",id:"storage-account",depth:4},{value:"Event Subscription",id:"event-subscription",depth:4},{value:"IAM",id:"iam",depth:4},{value:"RunReveal Source Setup",id:"runreveal-source-setup",depth:2},{value:"Final Steps",id:"final-steps",depth:2}]}var h=(0,o.c)(function(e){let{toc:t=u(e)}=e,n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{children:"Azure Blob Storage"}),"\n",(0,r.jsx)(n.p,{children:"The current process for ingesting logs from Azure blob storage involves 3 steps."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Send your logs/events to a storage account to be saved as blob storage objects."}),"\n",(0,r.jsxs)(n.li,{children:["A ",(0,r.jsx)(n.em,{children:"Blob Created"})," event is triggered and adds a message to a Storage Queue."]}),"\n",(0,r.jsx)(n.li,{children:"Every minute, RunReveal will subscribe to your storage queue, pull any new notifications, and process the objects that are listed."}),"\n"]}),"\n",(0,r.jsxs)(d.U,{type:"info",children:[(0,r.jsx)(n.p,{children:"When setting up the Azure resources, each unique source will require its own storage queue in order to process events."}),(0,r.jsx)(n.p,{children:"RunReveal recommends using a separate storage account for each source but is not required."})]}),"\n",(0,r.jsx)(n.p,{children:"In order to setup this format you will need to create the following pieces in Azure:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Add a new App Registration to your Entra account. (This registraion can be reused between different sources)"}),"\n",(0,r.jsx)(n.li,{children:"Create a new Client Secret for this new app."}),"\n",(0,r.jsx)(n.li,{children:"Create a new Storage Account."}),"\n",(0,r.jsx)(n.li,{children:"Create an Event to notify on Blob Created event types and forward the notification to a Storage Queue."}),"\n",(0,r.jsx)(n.li,{children:"Provide access to the created app to read blob objects and process storage queue messages."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"For steps 3-5 RunReveal provides an Azure Deploy Template that can be used to simplify setup."}),"\n",(0,r.jsx)(n.h2,{id:t[0].id,children:t[0].value}),"\n",(0,r.jsxs)(n.p,{children:["The first step is to create a new App Registration. Navigate to the ",(0,r.jsx)(n.a,{href:"https://portal.azure.com/#view/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/~/Overview",children:"Microsoft Entra ID"})," service and choose Add -> App Registration."]}),"\n",(0,r.jsx)("img",{src:"/azure/azure-new-app.png"}),"\n",(0,r.jsxs)(n.p,{children:["Give the app a name and fill in the remaining settings for your organization. Once done click ",(0,r.jsx)(n.em,{children:"Register"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["You should now be presented with the details of the new app. Copy and save the ",(0,r.jsx)(n.code,{children:"Application (client) ID"})," and the ",(0,r.jsx)(n.code,{children:"Directory (tenant) ID"})," as these will be needed when setting up a RunReveal source.\nIf you plan to use the provided deploy template click on the link for the ",(0,r.jsx)(n.code,{children:"Managed application in local directory"}),", this will open a properties page where you will need to copy the listed ",(0,r.jsx)(n.code,{children:"Object ID"}),"."]}),"\n",(0,r.jsx)("img",{src:"/azure/azure-app-ids.png"}),"\n",(0,r.jsx)("img",{src:"/azure/azure-app-object-id.png"}),"\n",(0,r.jsx)(n.h3,{id:t[1].id,children:t[1].value}),"\n",(0,r.jsxs)(n.p,{children:["Once the app has been registered you will need to create a client secret to provide to RunReveal for access.\nBack on the main app registration page under the Manage category click on ‘Certificates & secrets’.\nFrom this screen click on the ‘Client secrets’ option and select ",(0,r.jsx)(n.code,{children:"New client secret"}),". Give the secret a name and choose an expiration date.\nOnce created copy the secret value and save it for later, this is needed when creating the source in RunReveal."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"client secret",placeholder:"blur",src:i})}),"\n",(0,r.jsx)(d.U,{type:"info",children:(0,r.jsx)(n.p,{children:"Set a reminder for the expiration date of this secret.\nYou will need to generate a new secret and update your RunReveal source before the expiration date to make sure RunReveal continues to have access."})}),"\n",(0,r.jsx)(n.h2,{id:t[2].id,children:t[2].value}),"\n",(0,r.jsx)(n.p,{children:"For each logging type (Activity Logs, Entra, etc) a new storage account must be created with the same setup.\nThe easiest way to set up your storage account is to use our deployment template. This will automatically setup the storage account, the object notifications, and provide the correct permissions for the created app."}),"\n",(0,r.jsx)(n.h3,{id:t[3].id,children:t[3].value}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Frunreveal%2Fazure-templates%2Fmain%2Fstorage-blob%2Fdeploy.json",children:(0,r.jsx)(n.img,{src:"https://aka.ms/deploytoazurebutton",alt:"Deploy to Azure"})})}),"\n",(0,r.jsxs)(n.p,{children:["Click on the to Azure button to load the template in the Azure portal. From there choose your ",(0,r.jsx)(n.em,{children:"Subscription"})," and ",(0,r.jsx)(n.em,{children:"Resource group"})," where this storage account should reside.\nGive the storage account a name and paste the App’s Object ID that was copied earlier. Wait for the deployment to complete, and click on the ",(0,r.jsx)(n.em,{children:"Outputs"})," menu item.\nThis will list the ",(0,r.jsx)(n.code,{children:"storageAccountName"})," and ",(0,r.jsx)(n.code,{children:"storageQueueName"})," that were created by the template. These values will be needed when setting up the RunReveal source."]}),"\n",(0,r.jsx)(d.U,{type:"warning",children:(0,r.jsx)(n.p,{children:"Azure displays multiple App object IDs, if the wrong one is used you may get a deployment error with the template. All of the resources will have been created but the IAM permissions will not have been set.\nYou can manually apply the needed permissions to the storage account if this happens."})}),"\n",(0,r.jsx)(n.h3,{id:t[4].id,children:t[4].value}),"\n",(0,r.jsx)(n.p,{children:"If you already have logs being stored in a storage account or want to change other setup settings follow these steps."}),"\n",(0,r.jsx)(n.h4,{id:t[5].id,children:t[5].value}),"\n",(0,r.jsxs)(n.p,{children:["Navigate to the ",(0,r.jsx)(n.a,{href:"https://portal.azure.com/#create/Microsoft.StorageAccount-ARM",children:"Storage account"})," creation page and create a new storage account to store your log files.\nThe only settings that we recommend is to select the ",(0,r.jsx)(n.code,{children:"Standard"})," performance option and to select the ",(0,r.jsx)(n.code,{children:"Hot"})," access tier."]}),"\n",(0,r.jsx)(n.h4,{id:t[6].id,children:t[6].value}),"\n",(0,r.jsxs)(n.p,{children:["In your new storage account resource, go to the Events menu and create a new ",(0,r.jsx)(n.code,{children:"Event Subscription"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Fill in the name fields for the subscription and system topic name and select ",(0,r.jsx)(n.code,{children:"Event Grid Schema"})," as the event schema. Change the event types to only filter for ",(0,r.jsx)(n.code,{children:"Blob Created"})," events.\nSelect ",(0,r.jsx)(n.code,{children:"Storage Queue"})," as your endpoint type and configure a new queue. For the easiest setup, we recommend putting the storage queue in the same storage account.\nMake sure to take note of the name of the storage queue that was created as this will be needed in the RunReveal source."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"event sub",placeholder:"blur",src:c})}),"\n",(0,r.jsx)(n.h4,{id:t[7].id,children:t[7].value}),"\n",(0,r.jsxs)(n.p,{children:["Go to the access control (IAM) screen for your storage account and add a new Role assignment.\nYou will need to add two separate roles the first being ",(0,r.jsx)(n.code,{children:"Storage Blob Data Reader"})," and the second ",(0,r.jsx)(n.code,{children:"Storage Queue Data Message Processor"}),".\nFor both of these the member should be the App that was registered earlier."]}),"\n",(0,r.jsx)(n.h2,{id:t[8].id,children:t[8].value}),"\n",(0,r.jsxs)(n.p,{children:["Sources that allow you to use Azure storage accounts to ingest logs will all have the same setup.\nNavigate to the ",(0,r.jsx)(n.a,{href:"https://app.runreveal.com/dash/sources/add",children:"Connect a source"})," page and find the source you are adding.\nOnce open, select the ",(0,r.jsx)(n.code,{children:"Azure Storage Account"})," ingest method and fill in the fields."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"azure-setup",placeholder:"blur",src:l})}),"\n",(0,r.jsx)(n.p,{children:"You will need the tenant id, client id, and the client secret for the app that was created.\nYou will also need the storage account name and storage queue name where the notifications are being sent."}),"\n",(0,r.jsx)(d.U,{type:"info",children:(0,r.jsx)(n.p,{children:"The storage account name that is provided should be the location of the storage queue, not necessarily the location of the blob objects.\nThe storage account of the blob object is listed in the notification that is created."})}),"\n",(0,r.jsx)(n.h2,{id:t[9].id,children:t[9].value}),"\n",(0,r.jsx)(n.p,{children:"At this point all of the pieces are in place for RunReveal to access logs stored in the bucket.\nContinue to the source docs for specific instructions on how to get your logs into the storage account."})]})},"/sources/object-storage/azure",{filePath:"pages/sources/object-storage/azure.mdx",timestamp:1750451516e3,pageMap:a.v,frontMatter:{title:"Azure",description:"Configure Azure Blob Storage for log ingestion in RunReveal. Set up storage accounts, event subscriptions, and queue processing for automated log collection."},title:"Azure"},"undefined"==typeof RemoteContent?u:RemoteContent.useTOC)},95956:function(e,t,n){"use strict";n.d(t,{U:function(){return c}});var r=n(85893),o=n(90512),a=n(45192);let s={default:"\uD83D\uDCA1",error:"\uD83D\uDEAB",info:(0,r.jsx)(a.AV,{className:"_mt-1"}),warning:"⚠️"},i={default:(0,o.Z)("_border-orange-100 _bg-orange-50 _text-orange-800 dark:_border-orange-400/30 dark:_bg-orange-400/20 dark:_text-orange-300"),error:(0,o.Z)("_border-red-200 _bg-red-100 _text-red-900 dark:_border-red-200/30 dark:_bg-red-900/30 dark:_text-red-200"),info:(0,o.Z)("_border-blue-200 _bg-blue-100 _text-blue-900 dark:_border-blue-200/30 dark:_bg-blue-900/30 dark:_text-blue-200"),warning:(0,o.Z)("_border-yellow-100 _bg-yellow-50 _text-yellow-900 dark:_border-yellow-200/30 dark:_bg-yellow-700/30 dark:_text-yellow-200")};function c({children:e,type:t="default",emoji:n=s[t]}){return(0,r.jsxs)("div",{className:(0,o.Z)("nextra-callout _overflow-x-auto _mt-6 _flex _rounded-lg _border _py-2 ltr:_pr-4 rtl:_pl-4","contrast-more:_border-current contrast-more:dark:_border-current",i[t]),children:[(0,r.jsx)("div",{className:"_select-none _text-xl ltr:_pl-3 ltr:_pr-2 rtl:_pr-3 rtl:_pl-2",style:{fontFamily:'"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"'},children:n}),(0,r.jsx)("div",{className:"_w-full _min-w-0 _leading-7",children:e})]})}}},function(e){e.O(0,[7812,4854,2888,9774,179],function(){return e(e.s=50326)}),_N_E=e.O()}]);