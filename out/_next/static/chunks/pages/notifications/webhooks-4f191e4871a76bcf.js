(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3609],{46700:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/notifications/webhooks",function(){return s(25896)}])},25896:function(e,n,s){"use strict";s.r(n),s.d(n,{useTOC:function(){return h}});var i=s(85893),t=s(37812),a=s(84854),r=s(79299);function h(e){return[{value:"Schema",id:"schema",depth:2},{value:"Webhook Signing",id:"webhook-signing",depth:2}]}n.default=(0,t.c)(function(e){let{toc:n=h(e)}=e,s={code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",span:"span",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.h1,{children:"Webhooks"}),"\n",(0,i.jsx)(s.p,{children:"RunReveal will send HTTP POST request to a URL of your choosing along with the data that is associated with the detection."}),"\n",(0,i.jsx)(s.p,{children:"Set this up using the Notification page in the RunReveal dashboard."}),"\n",(0,i.jsx)("img",{style:{maxWidth:"500px"},src:"/webhook-notification-1.png"}),"\n",(0,i.jsx)(s.h2,{id:n[0].id,children:n[0].value}),"\n",(0,i.jsx)(s.p,{children:"The following shows the schema of the data that is sent in the webhook."}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Property"}),(0,i.jsx)(s.th,{children:"Data Type"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"title"}),(0,i.jsx)(s.td,{children:"string"}),(0,i.jsx)(s.td,{children:"The template title that was rendered."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"message"}),(0,i.jsx)(s.td,{children:"string"}),(0,i.jsx)(s.td,{children:"The template body that was rendered."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"query"}),(0,i.jsx)(s.td,{children:"scheduled query response"}),(0,i.jsx)(s.td,{children:"The field will be null if the notification was created from a trigger. Otherwise it will contain the data of the scheduled query."})]})]})]}),"\n",(0,i.jsx)(s.h2,{id:n[1].id,children:n[1].value}),"\n",(0,i.jsx)(s.p,{children:"Webhooks have a webhook secret that we use to sign the request body, along with a timestamp header we pass along with the notification."}),"\n",(0,i.jsx)(s.p,{children:"The webhook integrity hash is calculated by concatenating the timestamp header and the HTTP request post body together, and calculating a SHAHMAC256 using the secret key\nwe provide to you. Make sure when calculating the hash that the hex string is treated as a byte array."}),"\n",(0,i.jsx)("img",{src:"/webhook_secret_ui.png"}),"\n",(0,i.jsx)(s.p,{children:"The HTTP Headers that we send along with all Webhook Notifications are described as:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"RunReveal-Timestamp"})," — The timestamp in unix seconds that the webhook was generated."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"RunReveal-Integrity"})," — The integrity hash that we calculated using our shared key."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Here is an example function that we’ve used, in Golang, to successfully verify the webhooks."}),"\n",(0,i.jsx)(s.pre,{tabIndex:"0","data-language":"plaintext","data-word-wrap":"",children:(0,i.jsxs)(s.code,{children:[(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"func SHAHMAC256(key, data []byte) (string, error) {"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	mac := hmac.New(sha256.New, key)"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	_, err := mac.Write(data)"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	if err != nil {"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:'		return "", err'})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	}"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	hashBytes := mac.Sum(nil)"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	base64Hash := base64.StdEncoding.EncodeToString(hashBytes)"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	return base64Hash, nil"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"}"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"func TestVerifySha256(t *testing.T) {"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:'	var integrity = "3w7SmNuf5UHk9v0WV6IIACBx/dZazysTcU8fxowNQVI="'})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:'	var bodyPlusTime = `1720198139{"link":"https://app.runreveal.com/dash/detections/","message":"Yay! Your notification channel was tested successfully.","rawEvent":null,"test":{"status":true},"title":"RunReveal Notification Test"}`'})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:'	var key = "b0c374a4fbfec3ad6047495ca83b4df3d428ed100f51462683c96dcefd74998e"'})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	keyBytes, err := hex.DecodeString(key)"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	if err != nil {"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"		t.Fatal(err)"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	}"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	base64Integrity, err := base64.StdEncoding.DecodeString(integrity)"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	if err != nil {"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"		t.Fatal(err)"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	}"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	resultHash, err := SHAHMAC256(keyBytes, []byte(bodyPlusTime))"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	if err != nil {"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"		t.Fatal(err)"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	}"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	base64ResultHash, err := base64.StdEncoding.DecodeString(resultHash)"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	if err != nil {"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"		t.Fatal(err)"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	}"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	itWorked := hmac.Equal(base64Integrity, base64ResultHash)"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	if !itWorked {"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:'		t.Fatal("Integrity check failed")'})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"	}"})}),"\n",(0,i.jsx)(s.span,{children:(0,i.jsx)(s.span,{children:"}"})})]})}),"\n",(0,i.jsx)(s.p,{children:"Note, these signatures are calculated even for test notifications, so you can develop the code needed\nto verify webhook signatures in a straightforward way."})]})},"/notifications/webhooks",{filePath:"pages/notifications/webhooks.mdx",timestamp:1750451516e3,pageMap:a.v,frontMatter:{title:"Webhooks",description:"Send security alerts to custom systems via HTTP POST webhooks. Learn webhook schema, signing verification, and integration with external services."},title:"Webhooks"},"undefined"==typeof RemoteContent?h:RemoteContent.useTOC)}},function(e){e.O(0,[7812,4854,2888,9774,179],function(){return e(e.s=46700)}),_N_E=e.O()}]);