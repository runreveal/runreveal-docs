---
title: 'Pipelines Overview'
description: 'Fine-grained control over log event processing with topics, pipelines, and drop steps for advanced data routing and filtering.'
---

import { Image, Callout, Tabs, Steps } from 'nextra/components'

# Pipelines Overview

Pipelines provide fine-grained control over log event processing. They consist of **topics** (which filter events) and **pipelines** (which process the filtered events through a series of steps). By mixing and rearranging pipeline steps, you can control how your events are transformed before being sent to their destinations.

<Callout type="info">
<strong>Getting Started</strong>: Navigate to <strong>Pipelines</strong> in RunReveal to create your first topic and pipeline, or manage existing ones.
</Callout>

## Pipeline Architecture

```
Source → Topics (Filter) → Pipeline (Process) → Destination
```

### Event Flow
1. **Events arrive** from your configured sources
2. **Topics filter** events based on preconditions
3. **Pipelines process** filtered events through steps
4. **Events are sent** to their final destinations

## Topics: Event Filtering

Topics apply filters to select subsets of events before they enter a pipeline. They use preconditions to determine which events get routed to specific pipelines.

### Topic Preconditions
Topics use preconditions to determine which events get routed to specific pipelines:

- **Source-based**: Route events from specific sources (e.g., `webhook` sources)
- **Field-based**: Route events based on field values
- **Custom criteria**: Any combination of filtering conditions

### Managing Topics

To manage your topics, navigate to the [Pipelines Page](https://app.runreveal.com/dash/pipelines).

<img src="/routing-topic-list.png" width={600} style={{display: "block", margin: "0 auto", borderRadius: "5px"}}/>

**Topic Evaluation Order:**
- Events are evaluated against topics **from top to bottom**
- Events that don't match any custom topics go to the **default RunReveal pipeline**
- Topics can be reordered by dragging them up/down in the list

### Creating a Topic

<Steps>

### 1) Start Topic Creation

Click the **"Create Topic"** button to open the topic creation wizard.

<img src="/routing-topic-create-1.png" width={600} style={{display: "block", margin: "0 auto", borderRadius: "5px"}}/>

### 2) Configure Topic Details

Each topic needs a name and a precondition. The precondition determines which subset of events will be routed to your topic.

<img src="/routing-topic-create-2.png" width={600} style={{display: "block", margin: "0 auto", borderRadius: "5px"}}/>

**Example**: The precondition above matches any events coming from `webhook` sources.

### 3) Choose Pipeline Configuration

Configure where your matching events will be processed:

<img src="/routing-topic-create-3.png" width={600} style={{display: "block", margin: "0 auto", borderRadius: "5px"}}/>

**Options:**
- **Use an existing pipeline**: Reuse pipelines across multiple topics
- **Create a new pipeline**: Start with a fresh pipeline from scratch
- **Copy from an existing pipeline**: Build on top of existing processing

### 4) Configure Pipeline Steps

You're brought to the pipeline editor to configure how events are processed.

<img src="/routing-topic-create-4.png" width={600} style={{display: "block", margin: "0 auto", borderRadius: "5px"}}/>

Click **Complete** to finish the wizard and set up your new resources.

</Steps>

## Pipelines: Event Processing

Pipelines detail how events are processed before being sent to their final destinations. They consist of steps that are evaluated **in order from top to bottom**. Each step includes a function to apply and a precondition to select which events the step applies to.

<img src="/routing-pipeline-list.png" width={600} style={{display: "block", margin: "0 auto", borderRadius: "5px"}}/>

### Available Step Types

<Tabs items={['Transform', 'Enrich', 'Filter', 'Detect', 'Drop']} defaultIndex="0">

<Tabs.Tab>

### Transform
Apply data transformations to matching events.

**Use Cases:**
- Field mapping and normalization
- Data cleaning and formatting
- Schema standardization

**Documentation**: [Transform Documentation](/transforms)

</Tabs.Tab>

<Tabs.Tab>

### Enrich
Apply enrichment data to matching events.

**Use Cases:**
- Add threat intelligence data
- Include user context information
- Append geographic data

**Documentation**: [Enrichment Documentation](/enrichments)

</Tabs.Tab>

<Tabs.Tab>

### Filter
Apply source filters to matching events.

**Use Cases:**
- Include/exclude specific event types
- Filter by severity levels
- Apply custom filtering logic

**Documentation**: [Filtering Documentation](/filtering)

</Tabs.Tab>

<Tabs.Tab>

### Detect
Apply streaming detections to matching events.

**Use Cases:**
- Real-time threat detection
- Anomaly detection
- Pattern matching

**Documentation**: [Streaming Detection Documentation](/detections/sigma-streaming)

</Tabs.Tab>

<Tabs.Tab>

### Drop
**Drop matching events**, preventing them from being output to destinations.

**Use Cases:**
- Remove noise and unwanted events
- Filter out test data
- Exclude specific applications or users

**Documentation**: See [Drop Steps](#drop-steps-detailed-configuration) section below

</Tabs.Tab>

</Tabs>

### Creating a Pipeline

<Steps>

### 1) Access Pipeline Editor

Click **"Add Pipeline"** or edit an existing pipeline to open the pipeline editor.

<img src="/routing-pipeline-create-1.png" width={600} style={{display: "block", margin: "0 auto", borderRadius: "5px"}}/>

### 2) Build Your Pipeline

- **Left column**: Your pipeline steps
- **Right column**: Available steps to add
- **Drag and drop**: Add steps from right to left column
- **Reorder**: Drag steps up/down to change evaluation order

### 3) Configure Step Preconditions

Each step can have preconditions to determine which events it applies to.

</Steps>

<Callout type="warning">
<strong>Shared Pipeline Warning</strong>: When editing a pipeline shared between multiple topics, you'll be prompted to unlock it first. Changes affect all matching topics - proceed with caution.
</Callout>

## Drop Steps: Detailed Configuration

Drop steps prevent matching events from being sent to destinations and from being indexed in the UI. They use **preconditions** to determine which events to drop.

### How Drop Steps Work

Drop steps are evaluated in order from top to bottom. Once a step matches an event, that event is dropped and won't be processed by subsequent steps or sent to destinations.

### Precondition Types and Targeting Options

<Tabs items={['Exact Match', 'Not Equal', 'Regex', 'Is Empty', 'CIDR Match']} defaultIndex="0">

<Tabs.Tab>

### Exact Match
**Purpose**: Match exact string values

**Configuration:**
- **Field**: `normalized.actor.email`
- **Type**: `exact`
- **Value**: `user@example.com`

**Use Cases:**
- Specific user emails
- Exact IP addresses
- Precise field values

**Example:**
```json
{
  "field": "normalized.actor.email",
  "type": "exact",
  "value": "admin@company.com"
}
```

</Tabs.Tab>

<Tabs.Tab>

### Not Equal
**Purpose**: Exclude specific values

**Configuration:**
- **Field**: `normalized.service.name`
- **Type**: `notEqual`
- **Value**: `health-check`

**Use Cases:**
- Filter out noise
- Exclude test data
- Remove unwanted services

**Example:**
```json
{
  "field": "normalized.service.name",
  "type": "notEqual",
  "value": "health-check"
}
```

</Tabs.Tab>

<Tabs.Tab>

### Regex
**Purpose**: Pattern matching in log content

**Configuration:**
- **Field**: `rawLog`
- **Type**: `regex`
- **Value**: `"app_name","value":"Material Security"`

**Use Cases:**
- Complex patterns
- Multiple conditions
- Raw log analysis

**Example:**
```json
{
  "field": "rawLog",
  "type": "regex",
  "value": "\"app_name\",\"value\":\"Material Security\""
}
```

</Tabs.Tab>

<Tabs.Tab>

### Is Empty
**Purpose**: Find events with missing data

**Configuration:**
- **Field**: `normalized.src.ip`
- **Type**: `isEmpty`

**Use Cases:**
- Data quality checks
- Incomplete events
- Missing required fields

**Example:**
```json
{
  "field": "normalized.src.ip",
  "type": "isEmpty"
}
```

</Tabs.Tab>

<Tabs.Tab>

### CIDR Match
**Purpose**: Network-based filtering

**Configuration:**
- **Field**: `normalized.src.ip`
- **Type**: `cidrMatch`
- **Value**: `192.168.1.0/24`

**Use Cases:**
- Internal vs external traffic
- Subnet filtering
- Network segmentation

**Example:**
```json
{
  "field": "normalized.src.ip",
  "type": "cidrMatch",
  "value": "10.0.0.0/8"
}
```

</Tabs.Tab>

</Tabs>

### Field Targeting Options

#### Standard Fields
- `rawLog` - Entire raw log content
- `normalized.eventTime` - Processed event timestamp
- `normalized.eventName` - Processed event name
- `normalized.actor.email` - Actor's email address
- `normalized.src.ip` - Source IP address
- `normalized.service.name` - Service name

#### GJSON Path Targeting
For complex JSON structures, use GJSON paths:

**Example:**
- **Field**: `events.0.parameters.#(name="client_id").value`
- **Type**: `exact`
- **Value**: `115520757898459258175`

**GJSON Path Syntax:**
- `events.0` - First element in events array
- `parameters.#(name="client_id")` - Find parameter where name equals "client_id"
- `.value` - Extract the value field

### Common Drop Step Use Cases

<div className="space-y-6 mt-6">

<div className="bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow overflow-hidden">
  <div className="p-4">
    <h3 className="text-xl font-bold text-gray-900 dark:text-white mb-3">Drop by Application Name</h3>
    <div className="text-sm text-gray-600 dark:text-gray-400 mb-4">
      Remove events from specific applications that generate noise or aren't relevant for security analysis.
    </div>
    <div className="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
      <div className="space-y-2">
        <div><strong>Field:</strong> <code>rawLog</code></div>
        <div><strong>Type:</strong> <code>regex</code></div>
        <div><strong>Value:</strong> <code>"app_name","value":"Material Security"</code></div>
      </div>
    </div>
  </div>
</div>

<div className="bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow overflow-hidden">
  <div className="p-4">
    <h3 className="text-xl font-bold text-gray-900 dark:text-white mb-3">Drop by Client ID</h3>
    <div className="text-sm text-gray-600 dark:text-gray-400 mb-4">
      Filter out events from specific client applications using GJSON path targeting.
    </div>
    <div className="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
      <div className="space-y-2">
        <div><strong>Field:</strong> <code>events.0.parameters.#(name="client_id").value</code></div>
        <div><strong>Type:</strong> <code>exact</code></div>
        <div><strong>Value:</strong> <code>115520757898459258175</code></div>
      </div>
    </div>
  </div>
</div>

<div className="bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow overflow-hidden">
  <div className="p-4">
    <h3 className="text-xl font-bold text-gray-900 dark:text-white mb-3">Drop Health Check Events</h3>
    <div className="text-sm text-gray-600 dark:text-gray-400 mb-4">
      Remove automated health check and monitoring events that don't provide security value.
    </div>
    <div className="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
      <div className="space-y-2">
        <div><strong>Field:</strong> <code>normalized.eventName</code></div>
        <div><strong>Type:</strong> <code>regex</code></div>
        <div><strong>Value:</strong> <code>health|heartbeat|ping</code></div>
      </div>
    </div>
  </div>
</div>

<div className="bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow overflow-hidden">
  <div className="p-4">
    <h3 className="text-xl font-bold text-gray-900 dark:text-white mb-3">Drop Internal Traffic</h3>
    <div className="text-sm text-gray-600 dark:text-gray-400 mb-4">
      Exclude internal network traffic from security analysis to focus on external threats.
    </div>
    <div className="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
      <div className="space-y-2">
        <div><strong>Field:</strong> <code>normalized.src.ip</code></div>
        <div><strong>Type:</strong> <code>cidrMatch</code></div>
        <div><strong>Value:</strong> <code>10.0.0.0/8</code></div>
      </div>
    </div>
  </div>
</div>

</div>

## Important Considerations

### ⚠️ Source-Specific Behavior

<Callout type="warning">
<strong>Google Workspace Integration</strong>: Processes logs through Google Admin SDK, which changes the JSON structure of rawLog. Use GJSON paths or regex on rawLog for reliable targeting. Field paths may not match original audit log structure.
</Callout>

**Other Sources:**
- Most sources preserve original log structure
- Standard field targeting works as expected
- Check source documentation for specific behavior

### ⚠️ Performance Considerations

1. **Regex Performance**: Complex regex patterns can impact performance
2. **Field Path Complexity**: Deep GJSON paths are slower than simple field access
3. **Order Matters**: Place drop steps early in pipelines to reduce processing overhead

### ⚠️ Precondition Evaluation

1. **Top-to-Bottom**: Steps are evaluated in order
2. **First Match Wins**: Once a step matches, subsequent steps may not execute
3. **Empty Results**: Failed preconditions return empty results, not errors

## Best Practices

### Pipeline Design
- **Place drop steps early** in the pipeline to reduce processing overhead
- **Use specific preconditions** to avoid over-dropping
- **Test with sample data** before deploying

### Field Selection
- **Use `rawLog`** for complex pattern matching
- **Use `normalized` fields** for standard data
- **Use GJSON paths** for nested JSON structures

### Regex Patterns
- **Escape special characters**: `\"` for quotes
- **Use anchors when needed**: `^pattern$` for exact matches
- **Test patterns** with sample data

### Monitoring
- **Monitor pipeline metrics** for dropped events
- **Set up alerts** for unexpected drop rates
- **Review dropped events** periodically

## Example: Complete Drop Configuration

**Step Name**: Drop Material Security Events
**Step Type**: Drop
**Precondition Field**: `rawLog`
**Precondition Type**: `regex`
**Precondition Value**: `"app_name","value":"Material Security"`

This configuration will drop all events containing the Material Security app name anywhere in the rawLog content, providing a robust solution for filtering out unwanted audit events from your Google Workspace integration.
