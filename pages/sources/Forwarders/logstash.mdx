---
title: 'Logstash Log Forwarder'
description: 'Configure Logstash to forward logs to RunReveal using webhooks'
---

import { Callout, Tabs, Steps } from 'nextra/components'

# Logstash Log Forwarder

<Callout type="info">
**Before you begin**: Replace `YOUR_WEBHOOK_URL` with your actual RunReveal webhook URL from Step 1.
</Callout>

[Logstash](https://www.elastic.co/guide/en/logstash/current/index.html) can be configured to send data to RunReveal using the HTTP output plugin. It's designed to collect, parse, filter, and forward logs to various destinations, making it ideal for sending data to RunReveal.

---

## Quick Start

This setup demonstrates reading logs from a local file and forwarding them to your RunReveal webhook. The example creates test JSON logs, configures Logstash to monitor the log file, and sends events to RunReveal in real-time.

<Steps>

### Step 1: Create a Webhook Source in RunReveal

This step creates a webhook source in RunReveal and generates the webhook URL you'll need for Logstash configuration.

1. **Navigate to RunReveal**: Go to your RunReveal dashboard
2. **Create Source**: Click on "Sources" in the left sidebar
3. **Add Webhook**: Create a source for "[Structured Webhook or Generic Webhook](/sources/Forwarders#structured-webhooks)" based on your data format.
4. **Configure**: Give your webhook a name and description
5. **Copy URL**: Copy the generated webhook URL to use in your configuration. (It's always available after you save the source)

### Step 2: Install Logstash

This step installs Logstash on your system using your preferred method. Logstash will be used to collect, process, and forward logs to RunReveal.

<Tabs items={['macOS', 'Ubuntu/Debian', 'CentOS/RHEL', 'Docker', 'Binary']}>
  <Tabs.Tab>

```bash copy
# Install using Homebrew
brew install logstash

# Create config directory
mkdir -p ~/.config/logstash

# Verify installation
logstash --version
```

  </Tabs.Tab>
  <Tabs.Tab>

```bash copy
# Add Elastic repository
wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -
echo "deb https://artifacts.elastic.co/packages/8.x/apt stable main" | sudo tee /etc/apt/sources.list.d/elastic-8.x.list

# Install Logstash
sudo apt update
sudo apt install logstash

# Enable service
sudo systemctl enable logstash

# Verify installation
logstash --version
```

  </Tabs.Tab>
  <Tabs.Tab>

```bash copy
# Add Elastic repository
sudo rpm --import https://artifacts.elastic.co/GPG-KEY-elasticsearch
sudo cat > /etc/yum.repos.d/elastic.repo << EOF
[elastic-8.x]
name=Elastic repository for 8.x packages
baseurl=https://artifacts.elastic.co/packages/8.x/yum
gpgcheck=1
gpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch
enabled=1
autorefresh=1
type=rpm-md
EOF

# Install Logstash
sudo yum install logstash

# Enable service
sudo systemctl enable logstash

# Verify installation
logstash --version
```

  </Tabs.Tab>
  <Tabs.Tab>

```bash copy
# Pull Logstash image
docker pull docker.elastic.co/logstash/logstash:8.11.0

# Create config directory
mkdir -p $(pwd)/logstash-config

# Run Logstash container
docker run -d \
  --name logstash \
  -v $(pwd)/logstash-config:/usr/share/logstash/config \
  -v ~/logs:/logs \
  docker.elastic.co/logstash/logstash:8.11.0
```

  </Tabs.Tab>
  <Tabs.Tab>

```bash copy
# Download Logstash binary
wget https://artifacts.elastic.co/downloads/logstash/logstash-8.11.0.tar.gz

# Extract binary
tar -xzf logstash-8.11.0.tar.gz

# Move to system path
sudo mv logstash-8.11.0 /opt/logstash

# Create symlink
sudo ln -s /opt/logstash/bin/logstash /usr/local/bin/logstash

# Verify installation
logstash --version
```

  </Tabs.Tab>
</Tabs>

### Step 3: Create Test Logs

This step creates sample log files with security events that Logstash will monitor and forward to RunReveal. These logs simulate real application events for testing purposes.

<Tabs items={['macOS/Linux', 'Windows']}>
  <Tabs.Tab>

```bash copy
# Create log directory in your home directory
mkdir -p ~/logs/app

# Create sample application logs
cat > ~/logs/app/application.log << EOF
{"timestamp":"2024-01-15T10:30:00Z","level":"INFO","message":"User login successful","user_id":"12345","ip":"192.168.1.100"}
{"timestamp":"2024-01-15T10:31:00Z","level":"WARN","message":"Failed login attempt","user_id":"unknown","ip":"192.168.1.101"}
{"timestamp":"2024-01-15T10:32:00Z","level":"ERROR","message":"Database connection failed","error":"timeout","retry_count":3}
EOF

# Verify logs were created
ls -la ~/logs/app/
cat ~/logs/app/application.log
```

  </Tabs.Tab>
  <Tabs.Tab>

```powershell
# Create log directory in your home directory
New-Item -ItemType Directory -Path "$env:USERPROFILE\logs\app" -Force

# Create sample application logs
@"
{"timestamp":"2024-01-15T10:30:00Z","level":"INFO","message":"User login successful","user_id":"12345","ip":"192.168.1.100"}
{"timestamp":"2024-01-15T10:31:00Z","level":"WARN","message":"Failed login attempt","user_id":"unknown","ip":"192.168.1.101"}
{"timestamp":"2024-01-15T10:32:00Z","level":"ERROR","message":"Database connection failed","error":"timeout","retry_count":3}
"@ | Out-File -FilePath "$env:USERPROFILE\logs\app\application.log" -Encoding UTF8

# Verify logs were created
Get-ChildItem "$env:USERPROFILE\logs\app\"
Get-Content "$env:USERPROFILE\logs\app\application.log"
```

  </Tabs.Tab>
</Tabs>

### Step 4: Configure Logstash

This step creates the Logstash configuration file that defines how to collect logs and send them to RunReveal.

```json copy
# logstash.conf
input {
  file {
    path => "~/logs/app/*.log"
    start_position => "beginning"
    sincedb_path => "/dev/null"
  }
}

filter {
  json {
    source => "message"
  }
  
  mutate {
    add_field => {
      "eventName" => "LogEvent"
      "eventTime" => "%{@timestamp}"
      "readOnly" => false
      "service.name" => "application"
      "tags.source" => "logstash"
    }
  }
}

output {
  http {
    url => "YOUR_WEBHOOK_URL"
    http_method => "post"
    headers => {
      "Content-Type" => "application/json"
    }
    format => "json"
    mapping => {
      "eventName" => "%{eventName}"
      "eventTime" => "%{eventTime}"
      "readOnly" => "%{readOnly}"
      "message" => "%{message}"
      "service" => {
        "name" => "%{service.name}"
      }
      "tags" => {
        "source" => "%{tags.source}"
      }
    }
  }
}
```

### Step 5: Start Logstash

This step starts Logstash with your configuration, which will begin monitoring the log files and forwarding events to RunReveal in real-time. Logstash will continuously watch for new log entries and send them to your webhook.

```bash copy
# Validate configuration
logstash -f logstash.conf --config.test_and_exit

# Test configuration locally (optional)
logstash -f logstash.conf --config.test_and_exit --verbose

# Run Logstash in foreground
logstash -f logstash.conf

# Run Logstash in background
logstash -f logstash.conf -d
```

**Local Testing Commands:**

```bash copy
# Test with a simple HTTP endpoint first
curl -X POST http://localhost:8080/test -H "Content-Type: application/json" -d '{"test": "data"}'

# Test Logstash configuration with local file output
# Create a test config that outputs to a local file instead of HTTP
cat > logstash-test.conf << EOF
input {
  file {
    path => "~/logs/app/*.log"
    start_position => "beginning"
    sincedb_path => "/dev/null"
  }
}

output {
  file {
    path => "/tmp/logstash-test.log"
    codec => json
  }
}
EOF

# Run test configuration
logstash -f logstash-test.conf

# Check the test output
tail -f /tmp/logstash-test.log
```


### Step 6: Validate Delivery

This step verifies that logs are successfully being delivered to RunReveal by checking the webhook source and querying for events.

1. **Check Webhook Source**: Go to RunReveal → Sources → Your webhook source
2. **View Recent Events**: Look for recent events in the source details
3. **Query for Events**: Use the query `sourceType = 'webhook'` or `sourceType = 'structured-webhook'` to find your events

</Steps>

---

## Logstash Configuration

<Tabs items={['Inputs', 'Filters', 'Outputs']}>
  <Tabs.Tab>

### Inputs

Inputs collect data from various sources. For RunReveal, you'll typically use file inputs or system inputs. See the [Logstash Input Plugins Reference](https://www.elastic.co/guide/en/logstash/current/input-plugins.html) for comprehensive documentation.

**File Input Example**
```json copy
input {
  file {
    path => "/var/log/app/*.log"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    type => "application"
  }
}
```

Collects application logs in JSON format, perfect for security event analysis and compliance reporting.

**System Input Example**
```json copy
input {
  file {
    path => "/var/log/syslog"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    type => "system"
  }
}
```

Captures system authentication and authorization events, essential for security monitoring and threat detection.

**Docker Input Example**
```json copy
input {
  file {
    path => "/var/lib/docker/containers/*/*.log"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    type => "container"
  }
}
```

Monitors containerized applications for security incidents, performance issues, and compliance violations.

  </Tabs.Tab>
  <Tabs.Tab>

### Filters

Filters process and transform data as it flows through the pipeline. For RunReveal, you'll typically use JSON parsing, mutation, or conditional filters. See the [Logstash Filter Plugins Reference](https://www.elastic.co/guide/en/logstash/current/filter-plugins.html) for comprehensive documentation.

**JSON Parser Example**
```json copy
filter {
  json {
    source => "message"
  }
  
  mutate {
    add_field => {
      "eventName" => "LogEvent"
      "eventTime" => "%{@timestamp}"
      "readOnly" => false
      "service.name" => "application"
      "tags.source" => "logstash"
    }
  }
}
```

Parses JSON-formatted logs into structured fields for better analysis and querying.

**Conditional Filter Example**
```json copy
filter {
  if [type] == "application" {
    json {
      source => "message"
    }
  }
  
  if [level] == "DEBUG" {
    drop {}
  }
  
  mutate {
    add_field => {
      "environment" => "production"
      "hostname" => "%{host}"
    }
  }
}
```

Applies different processing rules based on log type and filters out unwanted events.

**Date Filter Example**
```json copy
filter {
  date {
    match => [ "timestamp", "ISO8601" ]
    target => "@timestamp"
  }
  
  mutate {
    add_field => {
      "eventName" => "LogEvent"
      "eventTime" => "%{@timestamp}"
    }
  }
}
```

Transforms timestamps to proper format and adds required fields for RunReveal.

  </Tabs.Tab>
  <Tabs.Tab>

### Outputs

Outputs send data to external destinations. For RunReveal, you'll configure HTTP output to send logs via webhooks. See the [Logstash Output Plugins Reference](https://www.elastic.co/guide/en/logstash/current/output-plugins.html) for comprehensive documentation.

**HTTP Output Example**
```json copy
output {
  http {
    url => "YOUR_WEBHOOK_URL"
    http_method => "post"
    headers => {
      "Content-Type" => "application/json"
    }
    format => "json"
    mapping => {
      "eventName" => "%{eventName}"
      "eventTime" => "%{eventTime}"
      "readOnly" => "%{readOnly}"
      "message" => "%{message}"
      "service" => {
        "name" => "%{service.name}"
      }
      "tags" => {
        "source" => "%{tags.source}"
      }
    }
  }
}
```

Sends logs to RunReveal via HTTP POST requests with proper JSON formatting and field mapping.

**Batch Configuration Example**
```json copy
output {
  http {
    url => "YOUR_WEBHOOK_URL"
    http_method => "post"
    headers => {
      "Content-Type" => "application/json"
    }
    format => "json"
    retry_non_idempotent => true
    request_timeout => 30
  }
}
```

Configures batch processing for optimal throughput and reduced network overhead.

**Multiple Outputs Example**
```json copy
output {
  if [type] == "security" {
    http {
      url => "YOUR_WEBHOOK_URL"
      http_method => "post"
      headers => {
        "Content-Type" => "application/json"
      }
      format => "json"
    }
  }
  
  if [type] == "application" {
    http {
      url => "YOUR_WEBHOOK_URL"
      http_method => "post"
      headers => {
        "Content-Type" => "application/json"
      }
      format => "json"
    }
  }
}
```


Routes different types of logs to separate endpoints for specialized processing.

  </Tabs.Tab>
</Tabs>

---

## Next Steps

Now that you have Logstash configured and logs flowing to RunReveal, explore the detailed configuration guides:

- **[Detections](/detections)** - Create and manage security detection rules
- **[Sigma Streaming](/detections/sigma-streaming)** - Use Sigma rules for standardized threat detection
- **[Detection as Code](/detections/detection-as-code)** - Manage detections through code and version control
- **[Notifications](/notifications)** - Set up alerting and notification channels
- **[AI Chat](/ai-chat)** - Use AI-powered analysis for threat hunting and investigation
- **[Enrichments](/enrichments)** - Add context and metadata to your security events
- **[Filters](/filtering)** - Create custom filters to focus on specific security events

---

## Troubleshooting

### Common Issues

1. **Logstash won't start**: Check the configuration syntax and file permissions
2. **No logs being sent**: Verify the log file paths exist and are readable
3. **Webhook errors**: Check that your webhook URL is correct and accessible
4. **Permission issues**: Ensure Logstash has read access to your log files

### Debug Commands

```bash copy
# Check Logstash status
sudo systemctl status logstash

# View Logstash logs
sudo journalctl -u logstash -f

# Test webhook connectivity
curl -v YOUR_WEBHOOK_URL

# Test configuration syntax
logstash -f logstash.conf --config.test_and_exit

# Run Logstash in debug mode
logstash -f logstash.conf --debug
```


### Performance Tuning

<Callout type="info">
**Best Practices:**

1. **Worker Threads**: Configure appropriate worker threads for your log volume
2. **Batch Processing**: Adjust batch sizes for optimal throughput
3. **Memory Limits**: Set appropriate heap size to prevent OOM issues
4. **Retry Logic**: Configure retry settings for failed webhook requests
5. **Monitoring**: Set up alerts for Logstash service failures
</Callout>

---

## Resources

- [Logstash Official Documentation](https://www.elastic.co/guide/en/logstash/current/index.html)
- [Logstash Configuration Reference](https://www.elastic.co/guide/en/logstash/current/configuration.html)
- [Logstash Input Plugins](https://www.elastic.co/guide/en/logstash/current/input-plugins.html)
- [Logstash Filter Plugins](https://www.elastic.co/guide/en/logstash/current/filter-plugins.html)
- [Logstash Output Plugins](https://www.elastic.co/guide/en/logstash/current/output-plugins.html)
- [Logstash GitHub Repository](https://github.com/elastic/logstash)
- [Elastic Community](https://discuss.elastic.co/)
