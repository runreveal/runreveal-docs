---
title: 'Fluent Bit Log Forwarder'
description: 'Configure Fluent Bit to forward logs to RunReveal using webhooks'
---

import { Callout, Tabs, Steps } from 'nextra/components'

# Fluent Bit Log Forwarder

[Fluent Bit](https://fluentbit.io/) is a lightweight log processor and forwarder that can send data to RunReveal. This guide shows you how to configure Fluent Bit to send logs that automatically map to RunReveal's structured data fields.

## Quick Start

<Steps>

### Step 1: Create a Webhook Source in RunReveal

1. **Navigate to RunReveal**: Go to your RunReveal dashboard
2. **Create Source**: Click on "Sources" → "Add Source" → "Structured Webhook"
3. **Name Your Source**: Give it a descriptive name like "Fluent Bit Logs"
4. **Copy the Webhook URL**: Save this URL - you'll need it in Step 4

Example URL format: `https://api.runreveal.com/sources/hook/YOUR_WEBHOOK_ID`

### Step 2: Install Fluent Bit

<Tabs items={['macOS', 'Ubuntu/Debian', 'Docker']}>
  <Tabs.Tab>

```bash copy
# Install using Homebrew
brew install fluent-bit

# Verify installation
fluent-bit --version
```

  </Tabs.Tab>
  <Tabs.Tab>

```bash copy
# Add repository and install
wget -qO - https://packages.fluentbit.io/fluentbit.key | sudo apt-key add -
echo "deb https://packages.fluentbit.io/ubuntu/focal focal main" | sudo tee -a /etc/apt/sources.list
sudo apt update
sudo apt install fluent-bit

# Verify installation
fluent-bit --version
```

  </Tabs.Tab>
  <Tabs.Tab>

```bash copy
# Pull and run Fluent Bit container
docker run -ti fluent/fluent-bit:latest --version
```

  </Tabs.Tab>
</Tabs>

### Step 3: Create Test Logs

Create a sample log file with RunReveal's structured data fields:

```bash copy
# Create a test directory
mkdir fluent-bit-test && cd fluent-bit-test

# Create sample logs with RunReveal fields
cat > application.log << 'EOF'
{"eventName":"FailedLogin","eventTime":"2024-01-15T10:30:00Z","readOnly":false,"actor":{"username":"admin","id":"ADM001"},"src":{"ip":"203.0.113.45","port":22},"service":{"name":"ssh"},"tags":{"severity":"high","environment":"production"}}
{"eventName":"SuspiciousFileAccess","eventTime":"2024-01-15T10:31:00Z","readOnly":true,"actor":{"username":"service_user","id":"SVC001"},"src":{"ip":"192.168.1.100"},"resource":{"path":"/etc/shadow"},"service":{"name":"file-monitor"},"tags":{"severity":"critical","environment":"production"}}
{"eventName":"NetworkConnection","eventTime":"2024-01-15T10:32:00Z","readOnly":true,"src":{"ip":"192.168.1.102","port":443},"dst":{"ip":"10.0.0.15","port":443},"service":{"name":"firewall"},"tags":{"protocol":"https","environment":"production"}}
EOF

echo "✅ Created test log file with 3 events"
```

<Callout type="info">
**RunReveal Fields**: When your logs include fields like `eventName`, `eventTime`, `actor`, `src`, `dst`, `service`, and `tags`, they automatically map to RunReveal's structured data model.
</Callout>

### Step 4: Configure Fluent Bit

<Callout type="warning">
**Why this configuration?** By default, Fluent Bit wraps file contents in a `log` field. Our configuration uses a JSON parser to extract your actual log data and send it properly to RunReveal.
</Callout>

Create the configuration files:

```bash copy
# Create the parser configuration
cat > parsers.conf << 'EOF'
[PARSER]
    Name        json
    Format      json
    Time_Key    eventTime
    Time_Format %Y-%m-%dT%H:%M:%SZ
EOF

# Create the main configuration
cat > fluent-bit.conf << 'EOF'
[SERVICE]
    Flush         1
    Log_Level     info
    Parsers_File  parsers.conf

[INPUT]
    Name              tail
    Path              application.log
    Tag               app_logs
    Parser            json
    Read_from_Head    true

[OUTPUT]
    Name    http
    Match   app_logs
    Host    api.runreveal.com
    Port    443
    URI     YOUR_WEBHOOK_URI_PATH
    tls     On
    Format  json
    Json_date_key    eventTime
    Json_date_format iso8601
EOF
```

Now update with your webhook URL:

```bash copy
# Replace with your actual webhook path
# If your URL is: https://api.runreveal.com/sources/hook/30vyA9aGH7ekqKUEcQhfoL0S9mk
# The URI path is: /sources/hook/30vyA9aGH7ekqKUEcQhfoL0S9mk

sed -i '' 's|YOUR_WEBHOOK_URI_PATH|/sources/hook/YOUR_WEBHOOK_ID|g' fluent-bit.conf
```

### Step 5: Start Fluent Bit

```bash copy
# Test the configuration
fluent-bit -c fluent-bit.conf --dry-run

# Run Fluent Bit
fluent-bit -c fluent-bit.conf
```

You should see output like:
```
[info] [output:http:http.0] worker #0 started
```

### Step 6: Verify in RunReveal

1. **Go to RunReveal** → Sources → Your webhook source
2. **Check for Events** - You should see your test events arriving
3. **Try a Query** - Search for `eventName = "FailedLogin"` or `actor.username = "admin"`

**Add a new test event to confirm it's working:**
```bash copy
echo '{"eventName":"LiveTest","eventTime":"'$(date -u +%Y-%m-%dT%H:%M:%SZ)'","readOnly":false,"service":{"name":"test"},"tags":{"source":"manual"}}' >> application.log
```

Check RunReveal again - you should see the new event within seconds.

</Steps>

---

## Production Configuration

### For System Logs

Monitor and forward your system security logs:

```ini copy
[INPUT]
    Name              tail
    Path              /var/log/auth.log
    Tag               auth_logs
    Parser            json
    Read_from_Head    false

[FILTER]
    Name        modify
    Match       auth_logs
    Add         eventName AuthEvent
    Add         service.name system-auth
    Add         tags.source fluent-bit

[OUTPUT]
    Name    http
    Match   auth_logs
    Host    api.runreveal.com
    Port    443
    URI     /sources/hook/YOUR_WEBHOOK_ID
    tls     On
    Format  json
```

### For Application Logs

Forward application logs with proper field mapping:

```ini copy
[INPUT]
    Name              tail
    Path              /var/log/app/*.json
    Tag               app_logs
    Parser            json
    DB                /var/log/fluent-bit-app.db
    Read_from_Head    false

[OUTPUT]
    Name    http
    Match   app_logs
    Host    api.runreveal.com
    Port    443
    URI     /sources/hook/YOUR_WEBHOOK_ID
    tls     On
    Format  json
    Retry_Limit 5
```

---

## Field Mapping

Your logs will automatically show in RunReveal when they include these fields:

| Field | Description | Example |
|-------|-------------|---------|
| `eventName` | Type of event | `"FailedLogin"`, `"FileAccess"` |
| `eventTime` | When it happened (ISO format) | `"2024-01-15T10:30:00Z"` |
| `actor` | Who did it | `{"username": "admin", "id": "123"}` |
| `src` | Source IP/port | `{"ip": "192.168.1.1", "port": 22}` |
| `dst` | Destination IP/port | `{"ip": "10.0.0.1", "port": 443}` |
| `service` | Service name | `{"name": "ssh"}` |
| `tags` | Additional metadata | `{"severity": "high", "env": "prod"}` |

---

## Troubleshooting

### No events appearing in RunReveal?

1. **Check Fluent Bit is running**: Look for errors in the terminal
2. **Verify your webhook URL**: Make sure you're using the URI path, not the full URL
3. **Test the webhook directly**:
   ```bash copy
   curl -X POST "https://api.runreveal.com/sources/hook/YOUR_WEBHOOK_ID" \
     -H "Content-Type: application/json" \
     -d '{"eventName":"Test","eventTime":"2024-01-15T10:30:00Z"}'
   ```

### Parser errors?

Make sure you have both `fluent-bit.conf` and `parsers.conf` files in the same directory.

### Need help?

- Check Fluent Bit logs: Add `-v` flag for verbose output
- Verify JSON format: Each log line must be valid JSON on its own line
- Contact RunReveal support with your webhook ID

---

## Next Steps

- **[Create Detections](/detections)** - Build security rules for your events
- **[Set Up Notifications](/notifications)** - Get alerts for critical events
- **[Explore AI Chat](/ai-chat)** - Use AI to analyze your security data

---

## Resources

- [Fluent Bit Documentation](https://docs.fluentbit.io/)
- [RunReveal Structured Webhooks](https://docs.runreveal.com/sources/source-types/structured-webhooks)
- [RunReveal Query Language](https://docs.runreveal.com/query-language)