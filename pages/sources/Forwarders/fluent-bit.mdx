---
title: 'Fluent Bit Log Forwarder'
description: 'Configure Fluent Bit to forward logs to RunReveal using webhooks'
---

import { Callout, Tabs, Steps } from 'nextra/components'

# Fluent Bit Log Forwarder

<Callout type="info">
**Before you begin**: Replace `YOUR_WEBHOOK_URL` with your actual RunReveal webhook URL from Step 1.
</Callout>

[Fluent Bit](https://fluentbit.io/) is a lightweight log processor and forwarder that can send data to RunReveal. It's designed for high performance and low resource usage, making it ideal for containerized environments and edge deployments.

---

## Quick Start

This setup demonstrates reading logs from a local file and forwarding them to your RunReveal webhook. The example creates test JSON logs, configures Fluent Bit to monitor the log file, and sends events to RunReveal in real-time.

<Steps>

### Step 1: Create a Webhook Source in RunReveal

This step creates a webhook source in RunReveal and generates the webhook URL you'll need for Fluent Bit configuration.

1. **Navigate to RunReveal**: Go to your RunReveal dashboard
2. **Create Source**: Click on "Sources" in the left sidebar
3. **Add Webhook**: Create a source for "[Structured Webhook or Generic Webhook](/sources/forwarders/forwarders#structured-webhooks)" based on your data format.
4. **Configure**: Give your webhook a name and description
5. **Copy URL**: Copy the generated webhook URL to use in your configuration. (It's always available after you save the source)

### Step 2: Install Fluent Bit

This step installs Fluent Bit on your system using your preferred method. Fluent Bit will be used to collect, process, and forward logs to RunReveal.

<Tabs items={['macOS', 'Ubuntu/Debian', 'CentOS/RHEL', 'Docker', 'Binary']}>
  <Tabs.Tab>

```bash copy
# Install using Homebrew
brew install fluent-bit

# Verify installation
fluent-bit --version
```

  </Tabs.Tab>
  <Tabs.Tab>

```bash copy
# Add Fluent Bit repository
wget -qO - https://packages.fluentbit.io/fluentbit.key | sudo apt-key add -

# Add repository
echo "deb https://packages.fluentbit.io/ubuntu/focal focal main" | sudo tee -a /etc/apt/sources.list

# Install Fluent Bit
sudo apt update
sudo apt install fluent-bit

# Verify installation
fluent-bit --version
```

  </Tabs.Tab>
  <Tabs.Tab>

```bash copy
# Add Fluent Bit repository
sudo rpm --import https://packages.fluentbit.io/fluentbit.key

# Add repository
cat <<EOF | sudo tee /etc/yum.repos.d/fluent-bit.repo
[fluent-bit]
name = Fluent Bit
baseurl = https://packages.fluentbit.io/centos/\$releasever/\$basearch/
gpgcheck=1
gpgkey=https://packages.fluentbit.io/fluentbit.key
enabled=1
EOF

# Install Fluent Bit
sudo yum install fluent-bit

# Verify installation
fluent-bit --version
```

  </Tabs.Tab>
  <Tabs.Tab>

```bash copy
# Pull Fluent Bit image
docker pull fluent/fluent-bit:latest
```

  </Tabs.Tab>
  <Tabs.Tab>

```bash copy
# Download Fluent Bit binary
wget https://fluentbit.io/releases/1.9/fluent-bit-1.9.0-linux-x86_64.tar.gz

# Extract
tar -xzf fluent-bit-1.9.0-linux-x86_64.tar.gz

# Move to system path
sudo mv fluent-bit-1.9.0-linux-x86_64/bin/fluent-bit /usr/local/bin/

# Verify installation
fluent-bit --version
```
  </Tabs.Tab>
</Tabs>

### Step 3: Create Test Logs

This step creates sample log files with security events that Fluent Bit will monitor and forward to RunReveal. These logs simulate real application events for testing purposes.

<Tabs items={['macOS/Linux', 'Windows']}>
  <Tabs.Tab>

```bash copy
# Create log directory
mkdir -p ~/logs/app

# Create sample application logs
cat > ~/logs/app/application.log << EOF
{"timestamp":"2024-01-15T10:30:00Z","level":"INFO","message":"User login successful","user_id":"12345","ip":"192.168.1.100"}
{"timestamp":"2024-01-15T10:31:00Z","level":"WARN","message":"Failed login attempt","user_id":"unknown","ip":"192.168.1.101"}
{"timestamp":"2024-01-15T10:32:00Z","level":"ERROR","message":"Database connection failed","error":"timeout","retry_count":3}
EOF

# Verify logs were created
ls -la ~/logs/app/
cat ~/logs/app/application.log
```

  </Tabs.Tab>
  <Tabs.Tab>

```powershell
# Create log directory
New-Item -ItemType Directory -Path "$env:USERPROFILE\logs\app" -Force

# Create sample application logs
@"
{"timestamp":"2024-01-15T10:30:00Z","level":"INFO","message":"User login successful","user_id":"12345","ip":"192.168.1.100"}
{"timestamp":"2024-01-15T10:31:00Z","level":"WARN","message":"Failed login attempt","user_id":"unknown","ip":"192.168.1.101"}
{"timestamp":"2024-01-15T10:32:00Z","level":"ERROR","message":"Database connection failed","error":"timeout","retry_count":3}
"@ | Out-File -FilePath "$env:USERPROFILE\logs\app\application.log" -Encoding UTF8

# Verify logs were created
Get-ChildItem "$env:USERPROFILE\logs\app\"
Get-Content "$env:USERPROFILE\logs\app\application.log"
```

  </Tabs.Tab>
</Tabs>

### Step 4: Configure Fluent Bit

This step creates the Fluent Bit configuration file that defines how to collect logs and send them to RunReveal.

```toml copy
[SERVICE]
    Flush        1
    Log_Level    info
    Parsers_File parsers.conf

[INPUT]
    Name        tail
    Path        ~/logs/app/*.log
    Parser      json
    Tag         app_logs
    Mem_Buf_Limit 5MB
    Skip_Long_Lines On

[OUTPUT]
    Name        http
    Match       app_logs
    URI         YOUR_WEBHOOK_URL
    Method      POST
    Header      Content-Type application/json
    Format      json
    Json_Date_Key timestamp
    Json_Date_Format iso8601
    Retry_Limit False
    HTTP_User   ""
    HTTP_Passwd ""
```

### Step 5: Start Fluent Bit

This step starts Fluent Bit with your configuration, which will begin monitoring the log files and forwarding events to RunReveal in real-time.

```bash copy
# Test configuration
fluent-bit -c fluent-bit.conf --dry-run

# Run Fluent Bit in foreground
fluent-bit -c fluent-bit.conf

# Run Fluent Bit in background
fluent-bit -c fluent-bit.conf -d
```

### Step 6: Validate Delivery

This step verifies that logs are successfully being delivered to RunReveal by checking the webhook source and querying for events.

1. **Check Webhook Source**: Go to RunReveal → Sources → Your webhook source
2. **View Recent Events**: Look for recent events in the source details
3. **Query for Events**: Use the query `sourceType = 'webhook'` or `sourceType = 'structured-webhook'` to find your events

</Steps>

---

## Fluent Bit Configuration

### Input Plugins

Fluent Bit supports various input plugins for collecting logs:

**File Input**
```ini copy
[INPUT]
    Name        tail
    Path        /var/log/app/*.log
    Parser      json
    Tag         app_logs
```

**Systemd Input**
```ini copy
[INPUT]
    Name        systemd
    Tag         systemd_logs
    Systemd_Filter _SYSTEMD_UNIT=docker.service
```

**TCP Input**
```ini copy
[INPUT]
    Name        tcp
    Listen      0.0.0.0
    Port        5170
    Tag         tcp_logs
```

### Output Plugins

**HTTP Output for RunReveal**
```ini copy
[OUTPUT]
    Name        http
    Match       *
    URI         YOUR_WEBHOOK_URL
    Method      POST
    Header      Content-Type application/json
    Format      json
    Json_Date_Key timestamp
    Json_Date_Format iso8601
```

### Processing

**JSON Parser**
```ini copy
[PARSER]
    Name        json
    Format      json
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S
```

**Filter Plugin**
```ini copy
[FILTER]
    Name        grep
    Match       *
    Regex       level ERROR
```

---

## Next Steps

Now that you have Fluent Bit configured and logs flowing to RunReveal, explore the detailed configuration guides:

- **[Detections](/detections)** - Create and manage security detection rules
- **[Sigma Streaming](/detections/sigma-streaming)** - Use Sigma rules for standardized threat detection
- **[Detection as Code](/detections/detection-as-code)** - Manage detections through code and version control
- **[Notifications](/notifications)** - Set up alerting and notification channels
- **[AI Chat](/ai-chat)** - Use AI-powered analysis for threat hunting and investigation
- **[Enrichments](/enrichments)** - Add context and metadata to your security events
- **[Filters](/filtering)** - Create custom filters to focus on specific security events

---

## Troubleshooting

### Common Issues

1. **Fluent Bit won't start**: Check the configuration syntax and file permissions
2. **No logs being sent**: Verify the log file paths exist and are readable
3. **Webhook errors**: Check that your webhook URL is correct and accessible
4. **Permission issues**: Ensure Fluent Bit has read access to your log files

### Debug Commands

```bash copy
# Check Fluent Bit status
ps aux | grep fluent-bit

# Test webhook connectivity
curl -v YOUR_WEBHOOK_URL

# Test configuration syntax
fluent-bit -c fluent-bit.conf --dry-run

# Run Fluent Bit in verbose mode
fluent-bit -c fluent-bit.conf -vv

# Check log files
ls -la ~/logs/app/
```

### Performance Tuning

<Callout type="info">
**Best Practices:**

1. **Buffer Settings**: Configure appropriate memory buffers for your log volume
2. **Batch Size**: Adjust flush intervals to balance latency and throughput
3. **Retry Logic**: Configure retry settings for failed HTTP requests
4. **Resource Limits**: Set appropriate memory and CPU limits
5. **Monitoring**: Set up alerts for Fluent Bit process failures
</Callout>

---

## Resources

- [Fluent Bit Documentation](https://docs.fluentbit.io/)
- [Fluent Bit GitHub Repository](https://github.com/fluent/fluent-bit)
- [Fluent Bit Configuration](https://docs.fluentbit.io/manual/configuration/)
- [RunReveal Community](https://github.com/runreveal/runreveal)
- [RunReveal Support](https://runreveal.com/support)
